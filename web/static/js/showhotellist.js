!function(e,n,r){var a=/%20/g,t=/\r?\n/g,i=/^(?:submit|button|image|reset|file)$/i,o=/^(?:input|select|textarea|keygen)/i,u=/^(?:checkbox|radio)$/i,c={makeArray:function(e){var n=[];if(!e.length)return n;try{return Array.prototype.slice.apply(e)}catch(r){for(var a=0,t=e.length;a<t;a++)n.push(e[a]);return n}},param:function(e){var n=[],r=function(e,r){r=null==r?"":r,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(r)};return"array"!==$.type(e)?"":(e.each(function(e){r(e.name,e.value)}),n.join("&").replace(a,"+"))},objParam:function(e){var n={};return"array"!==$.type(e)?{}:(e.each(function(e){n[encodeURIComponent(e.name)]=encodeURIComponent(e.value)}),n)},serializeArray:function(n){return c.makeArray(n.elements).filter(function(n){var r=n.type;return n.name&&!e(n).is(":disabled")&&o.test(n.nodeName)&&!i.test(r)&&(n.checked||!u.test(r))}).map(function(n){var r=e(n).value();return null==r?null:{name:n.name,value:r.replace(t,"\r\n")}})},serialize:function(e){return c.param(c.serializeArray(e))}};n.Serialize=c}(cQuery,cQuery.BizMod);
!function(e,t){function i(i){e(t).bind("scroll",i),e(t).bind("resize",function(){l.visibleHeight=s()})}function o(e,t,i){var o=l.visibleHeight;return t<o+e&&t+i>e}function n(e,t){for(var i,o=0,n=e.length;o<n;o++)if(i=e[o],i.dom[0]===t[0])return{obj:i,index:o}}function r(e){}function s(){return t.innerHeight||e("html").offset().height}function l(t){var o=this;o.options={delay:800},e.extend(o.options,t||{}),o.observed=[],o._lastVisibleIndex=0,o.__scrollHandler=function(e){clearTimeout(o._timer),o._timer=setTimeout(function(){var e=c.documentElement.scrollTop||c.body.scrollTop;o.__checkWith(e)},e>-1||o.options.delay)},l.visibleHeight=s(),i(this.__scrollHandler)}var c=t.document,f=!1;l.prototype={constructor:l,observe:function(e){var t=this,i=t.observed;e.each(function(e){i.push({dom:e,visible:!1,offset:e.offset()})})},unObserve:function(e){var t=this;t.observed.length&&(delete t.observed,t.observed=[])},update:function(i,o){var r,s=this,l=n(s.observed,i);l?(r=l.index,s.observed.slice(r).each(function(e){s._updateOffset(e)}),o&&o(),e(t).trigger("scroll")):s.updateAll()},updateAll:function(i){var o=this;o.observed.each(function(e){o._updateOffset(e)}),i&&i(),e(t).trigger("scroll")},_updateOffset:function(e){e.offset=e.dom.offset()},_stop:function(){},_start:function(){},__checkWith:function(t){if(!(t<0)){var i,n,s,l=this,c=[],a=l.observed,u=a.length,d=l._lastVisibleIndex;for(i=d;i<u;i++)if(s=a[i],n=o(t,s.offset.top,s.offset.height),n!==s.visible&&s.dom.trigger("change",{arguments:[n]}),s.visible=n,1==n)c.push(s);else if(f)break;f=!1,c.length&&r(c);var h="";c.each(function(e,t){h+=t===c.length-1?e.dom.attr("id"):e.dom.attr("id")+","});var v=e("#htl_search_result_rollingscreen_map"),b="pageid="+e("#page_id").value()+';hotellist="'+h+'";clicktime='+(new Date).toFormatString("yyyy-MM-dd hh:mm:ss")+";others=";v.value(b),window.__bfi.push(["_tracklog",v.attr("data-key"),b])}}},cQuery.ScrollObserver=l}(cQuery,window);
!function(t){function e(t){this.opts={inputCDom:[],divClass:"",itemClass:"",hoverClass:"",onChange:o,onSelection:o},i(this.opts,t||{}),this.isShow=!1;var e=document.createElement("div");e.className=this.opts.divClass,e.style.cssText="display:none;position:absolute;z-index:20001;background-color:#fff",document.body.appendChild(e),this.div=e,this._bindEvent()}var o=function(){},i=t.extend;e.prototype={constructor:e,_bindEvent:function(){var t=this,e=t.opts.inputCDom;e.attr("lastvalue",e.value()),e.bind("keyup",function(o){if(13!==o.keyCode){var i=e.value();i!==e.attr("lastvalue")&&(e.attr("lastvalue",i),t.opts.onChange.call(this))}}),e.bind("keydown",function(o){if(t.isShow){var i=t.items.length-1,s=t.hoverItemIndex;switch(o.keyCode){case 38:s-=1,s<0&&(s=i),t._addHover(s);break;case 40:s+=1,s>i&&(s=0),t._addHover(s);break;case 13:o.stop(),e.value()?(t.opts.onSelection(t.hoverItem[0]),e.trigger("blur")):(t.div.innerHTML="",t.div.style.display="none");break;case 37:case 39:o.stop()}}}),e.bind("blur",function(e){t.div.innerHTML="",t.div.style.display="none"})},_addHover:function(e){this.hoverItemIndex=e;var o=this.opts.hoverClass;t(this.div).find("."+o).removeClass(o);var i=t(this.items[e]);i.addClass(o),this.hoverItem=i},_position:function(){var e=this.div,o=this.opts.inputCDom.offset(),i=t(e).offset(),s=window.innerWidth||document.documentElement.clientWidth||document.body.offsetWidth,n=window.innerHeight||document.documentElement.clientHeight||document.body.offsetHeight,d=document.documentElement.scrollTop||document.body.scrollTop;e.style.right=s-o.right+"px",d+n-o.top-o.height>i.height?e.style.top=o.top+o.height+"px":o.top-d>i.height?e.style.top=o.top-i.height+"px":e.style.top=o.top+o.height+"px"},onReady:function(e){var o=this,i=t(this.div);if(!e)return void i.hide();i.html(e),i.show(),this.isShow=!0;var e=i.find("."+this.opts.itemClass),s=this.opts.hoverClass;e.bind("mouseover",function(){i.find("."+s).removeClass(s),t(this).addClass(s)}).bind("mouseout",function(){t(this).removeClass(s)}).bind("mousedown",function(){o.opts.onSelection(this),o.opts.inputCDom.trigger("blur")}),this.items=e,this._addHover(0),this._position()}},t.Autocomplete=e}(cQuery);
"use strict";!function(e,t){function i(e){p(O,!0),O=e,m||(Z(),m=CtripHotelMap.dialog({obj:z[0],onChange:l,onShow:n,onHide:o}),z.find(".delete").bind("click",function(){m.hide()})),m.show(),p(O)}function n(){T&&(D.doSelect(O),D.doSyncIn())}function o(){D.doReset()}function s(){I=!0,y.removeClass("shangyequ_side_hidden"),_.css("display","none"),S.css({display:""}),f.setMapSize(H.w-x,H.h),f.getCMapObject().mapBox.style.left=x+"px",f.getCMapObject().mapBox.style.position="absolute"}function a(){I=!1,y.addClass("shangyequ_side_hidden"),_.css({display:""}),S.css("display","none"),f.setMapSize(H.w,H.h),f.getCMapObject().mapBox.style.left="",f.getCMapObject().mapBox.style.position=""}function l(e){var i=document.getElementById("J_bizMapBox");return H.w=e.w,H.h=e.h,C.css("height",H.h-102+"px"),T?void f.setMapSize(H.w-(I?x:0),H.h):(T=!0,f=CtripHotelMap.map({map:{level:13,resizeEnable:!0},width:H.w-(I?x:0),height:H.h,el:i,infowinTpl:B}),f.makeMap(function(){h=f.getCMapObject().ifmWin,t("#J_bizMapPop .map_pop_loading").css("display","none"),y.css("display",""),f.addPlugin(["ToolBar","OverView","Scale"],function(e,t,i){e.create().addToControl(),t.create().addToControl(),i.create().addToControl()}),d(),i.style.left=x+"px",i.style.position="absolute"}),_.bind("click",s),S.bind("click",a),void k.bind("click",function(){D.doSyncBack(),m.hide()}))}function d(){t.loader.jsonp(A,{charset:"gb2312",onload:function(e){var t=[];return e?(W.each(function(i){e[i]&&e[i].each(function(e){e.uid=e.id,e.url=F+e.id,u(e),t.push({id:e.id,name:e.name})})}),r(e),App.updateAddition({zoneList:t}),y.find(".business_list_btn").css("display",""),c(),void p(O)):(a(),void c())},onerror:function(){a(),c()}})}function c(){if(N)f.autoFit(),p(O);else{var e=t("#cityLat").value(),i=t("#cityLng").value();e&&i?f.setCenter({lat:e,lng:i}):f.autoFit(),p(O)}}function r(e){C.html(t.tmpl.render(w,{data:e})),D.doSelect(O),D.doSyncIn(),C.find("label").bind("mouseenter",function(){var e=t(this).find("input"),i=e.value(),n=L[i];D.isSelected(O)||p(O,!0),n&&(g=setTimeout(function(){p(i,"","","",!0),f.panTo(n.getPosition())},500))}).bind("mouseleave",function(){var e=t(this).find("input"),i=e.value(),n=L[i];clearTimeout(g),n&&(D.isSelected(i)?p(i,!1,!0,!0):p(i,!0))}).bind("click",function(){var e=t(this).find("input"),i=e[0].checked,n=e.value();i?D.doSelect(n):D.doClear(n)})}function u(e){var i=[],n=e.lng+"|"+e.lat,o=e.uid,s=e.path;e.lng&&e.lat&&(E[o]=t.tmpl.render(M,e),L[o]=f.addMarker({cpos:n,cpix:"T"===IsGAT||"F"===IsLatlonOffset?"-18|-36":"-13.5|-31",content:R(E[o],h),zIndex:20},o),s&&(s.each(function(e){i.push(f.setLngLat(e.lng+"|"+e.lat))}),j[o]=f.addPolygon({path:i,strokeColor:"#006600",strokeOpacity:.5,strokeWeight:1,fillColor:"#789456",fillOpacity:.3}),j[o].hide()),e.desc&&(P[o]=f.showInfoWindow({location:f.setLngLat(n),size:f.setSize("422|0")},void 0,{content:t.tmpl.render(B,e),offset:f.setPixel("0|-50"),isCustom:!0,noshow:!0,autoFit:!0})),L[o].bindEvent("mouseover",function(){D.isSelected(O)||p(O,!0),p(o,!1,!0)}).bindEvent("mouseout",function(){D.isSelected(o)?p(o,!1,!0,!0):p(o,!0)}).bindEvent("click",function(){D.doToggle(o)}))}function p(e,i,n,o,s){var a=L[e];if(a)if(i)J?a.setContent(R(E[e],h)):t(a.getContent()).removeClass("shangyequ_map_mark_hover"),a.setzIndex(20),j[e]&&j[e].hide(),f.closeInfoWindow(P[e]);else{if(J){var l=R(E[e],h);l.className="shangyequ_map_mark shangyequ_map_mark_hover",a.setContent(l)}else t(a.getContent()).addClass("shangyequ_map_mark_hover");a.setzIndex(21),j[e]&&j[e].show(),f[o?"closeInfoWindow":"openInfoWindow"](P[e],null,s),!n&&f.panTo(a.getPosition())}}var f,h,m,g,v,b,y,C,z,_,S,k,w,M,B,T=!1,x=391,I=!0,J=t.browser.isIE6,O=void 0,L={},E={},j={},P={},W=["ABCDE","FGHJK","LMNOP","QRSTW","XYZ"],q=hotelDomesticConfig.city,A=addressUrlConfig.cityZone+"?city="+q.id,F="/hotel/"+q.py+q.id+"/zone",N="1"===hotelDomesticConfig.istaiwan,H={},D={selectedBiz:[],isSelected:function(e){var i;if("number"===t.type(e))i=e;else{if("string"!==t.type(e))return!1;i=Number(e)}return this.selectedBiz.indexOf(i)>=0},doSelect:function(e){var t,i=Number(e);this.isSelected(i)||(t=C.find("input[value="+i+"]"),t.length>0&&(this.selectedBiz.push(i),t[0].checked=!0,p(i,!1,!0,!0)))},doClear:function(e){var t,i=Number(e),n=this.selectedBiz.indexOf(i);this.isSelected(i)&&(this.selectedBiz.splice(n,1),t=C.find("input[value="+i+"]"),t.length>0&&(C.find("input[value="+i+"]")[0].checked=!1,p(i,!0)))},doToggle:function(e){this.isSelected(e)?this.doClear(e):this.doSelect(e)},doSyncIn:function(){var e=App.getCheckedValue("zone");if("string"===t.type(e)){if(e=e.trim(),0===e.length)return;e=e.split(",")}if("array"===t.type(e))for(var i=0;i<e.length;i++)this.doSelect(e[i])},doSyncBack:function(){App.update({zone:this.selectedBiz.join(","),sl:"",l:"",s:"",location:"",page:1})},doReset:function(){for(var e=this.selectedBiz.slice(0),t=0;t<e.length;t++)this.doClear(e[t])}},R=function(e,t){var i=t?t.document.createElement("div"):document.createElement("div"),n=document.createDocumentFragment();i.innerHTML=e;var o=i.children;if(o.length>1){for(;o.length>0;)n.appendChild(o[0]);return n}return o[0]},Z=function(){v=document.forms[0],b=t("#cityName").value(),C=t("#J_bizList"),z=t("#J_bizMapPop"),y=t("#J_bizSide"),_=t("#J_bizSideOpen"),S=t("#J_bizSideClose"),k=t("#J_bizSide a.submit"),w=t("#J_bizListTpl").html(),M=t("#J_bizMarkerTpl").html(),B=t("#J_bizInfowinTpl").html()};t("#J_moreBizZone").bind("click",function(e){e.stop(),i()}),e.bizMap=i}(window,cQuery);
!function(t,e){"use strict";var o={extend:function(){var t,o,n=arguments[0]||{},i=1,s=arguments.length,a=!1;for("boolean"==typeof n&&(a=n,n=arguments[1]||{},i=2),s===i&&(n=this,--i);i<s;i++)if(null!=(t=arguments[i]))for(var h in t)o=t[h],n!==o&&o!==e&&(n[h]=o);return n}},n=function(t){this.init(t)};n.prototype={init:function(t){var e={obj:"",shade:{shadeObj:null,hasShade:!0,cssText:"z-index:10000;background:#000;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=50);opacity:0.5;left:0;top:0;position:absolute;display:none;"},hasScroll:!1,zIndex:10001,padding:"160|160",min:"700|580",hasResize:!0,onChange:function(){},onShow:function(){},onHide:function(){}};this.opts=o.extend(e,t),this.opts.obj&&(this.shade=this._createShade(),this.opts.obj.style.position="absolute",this.opts.obj.style.zIndex=this.opts.zIndex,this.opts.hasResize&&this.addResizer())},addResizer:function(){var e=this,o=null,n=200;t.addEventListener?t.addEventListener("resize",function(){clearTimeout(o),o=setTimeout(function(){e._render()},n)},!1):t.attachEvent("onresize",function(){clearTimeout(o),o=setTimeout(function(){e._render()},n)}),t.onorientationchange&&(t.onorientationchange=function(){clearTimeout(o),o=setTimeout(function(){e._render()},n)})},_createShade:function(){var t=this.opts.shade;if(!t.hasShade)return null;if(t.shadeObj)return t.shadeObj;var e=document.createElement("div"),o=this._getScreenInfo(),n="width:100%;height:"+o.h+"px;"+t.cssText;return e.style.cssText=n,document.body.appendChild(e),e},_getScreenInfo:function(){var t=document.body,e=document.documentElement;return{w:t.offsetWidth,h:t.offsetHeight,cw:e.clientWidth,ch:e.clientHeight,sl:e.scrollLeft||t.scrollLeft,st:e.scrollTop||t.scrollTop}},_render:function(t){var e=this.opts,o=e.obj;if(o){var n=this._getScreenInfo(),i=e.padding.split("|"),s=e.min.split("|"),a=Math.max(n.cw-i[0],s[0]),h=Math.max(n.ch-i[1],s[1]),r={w:a,h:h,l:Math.max((n.cw-a)/2+n.sl,0),t:Math.max((n.ch-h)/2+n.st,0)};o.style.width=r.w+"px",o.style.height=r.h+"px",o.style.left=r.l+"px",o.style.top=r.t+"px",e.onChange(r,t)}},show:function(t){var e=this.opts;if(e.obj){var o=this.shade;o&&(o.style.display="",e.hasScroll||(document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden")),this._render(t),e.obj.style.display="",this._show=!0,e.onShow(t)}},hide:function(t){var e=this.opts;if(e.obj){var o=this.shade;o&&(o.style.display="none",e.hasScroll||(document.documentElement.style.overflow="",document.body.style.overflow="")),e.obj.style.display="none",this._show=!1,e.onHide(t)}}},t.CtripHotelMap=t.CtripHotelMap||{},t.CtripHotelMap.dialog=function(t){return new n(t)}}(window,void 0);
"use strict";$.fn.show=function(){this.each(function(e){e.css("display","block")})},$.fn.hide=function(){this.each(function(e){e.css("display","none")})},function(e,t){var a,o=t.browser.isIPad,s=o?"touchstart":"click",i=222,r=0;(t.browser.isIE6||t.browser.isIE7)&&(r=8);var n={init:function(a){this.popAMap=a,this.CMap=a.CMap,this.C=e.hotelDomesticConfig,this.sideHeight=a.options.height,t("#J_mapSide").css("height",this.sideHeight+"px"),t("#J_aroundList").css("height",this.sideHeight-i+"px");var s=document.getElementById("cityCode").value,r=document.getElementById("cityName").value;this.cityName=r,this.curGeocode=s?s:encodeURIComponent(r),this.hotel=a.mapData,this.sgeocode=[],this.egeocode=[{formattedAddress:this.hotel.fullname,location:this.toLngLat(this.hotel.pos,"|")}],t("#J_endPoint").value(this.hotel.fullname);var n=t("#J_routeSearch"),c=t("#J_rounteSearchIPad");o&&(n.hide(),c.show(),c.bind("touchstart",function(){n.show(),c.hide(),t("#J_routeBack").css("display","inline"),t("#J_trafficHub").hide(),t("#J_aroundSearch").hide()})),this.queryTraffic(),this.queryAround(),this.routeSwitch(),this.foldSide()},reshow:function(e){var a=this,s=t("#J_endPoint"),i=t("#J_startPoint"),r=t("#J_aroundBox"),n=t("#J_aroundSearch"),c=t("#J_routeSearch"),d=t("#J_rounteSearchIPad"),l=t("#J_trafficHub"),u=t("#J_aroundList"),h=t(".bus_route_height, .route_detail_box"),p=t(".bus_sort"),g=t(".car_sort"),f=t("#J_startAndEnd"),_=t("#J_aroundBack, #J_routeBack, #J_routeSearchBox, #J_noRoute, #J_tooClose, #J_aroundListBox");a.reshow=function(e){a.hotel=e,a.sgeocode=[],a.egeocode=[{formattedAddress:e.fullname,location:a.toLngLat(e.pos,"|")}],s.value(a.hotel.fullname),i.value(""),t("#J_routeWay .selected").removeClass("selected"),t('#J_routeWay a[data-way="transfer"]').addClass("selected"),_.hide(),r[0].className="around_box",n.show(),c.show(),a.hasTrafficHub&&l.show(),o&&(c.hide(),d.show()),u.html(""),h.html(""),p.html(p.html()),g.html(g.html()),f.css({"background-color":"transparent",display:"none"})},a.reshow(e)},resize:function(e){this.sideHeight=e;var a=e-i,o=t("#J_aroundListType");"block"==o.css("display")&&(a=a-o.offset().height-12),t("#J_mapSide").css("height",e+"px"),t("#J_aroundList").css("height",a+"px"),t(".foot_route_result .route_detail_box").css("height",e-310-r+"px"),t(".car_route_result .route_detail_box").css("height",e-360-r+"px"),t(".bus_route_height").css("height",e-284-r+"px")},toLngLat:function(e,t){return this.CMap.setLngLat(e)},queryTraffic:function(){var e,a=this;e=this.C.query?this.C.query.cityId:this.C.city.id;var o="<span>|</span>",s=t("#J_trafficHub"),i=t("#J_airportItem"),r=i.parentNode(),n=t("#J_stationItem"),c=n.parentNode(),d=t("#J_routeBack");t.ajax("/Domestic/Tool/AjaxGetPositions.aspx?city="+e,{onsuccess:function(e,l){if(l=t.parseJSON(l)){var u=[],h=[],p=l.airport||[];p.length?(a.hasTrafficHub=!0,"inline"!=d[0].style.display&&s.show()):a.hasTrafficHub=!1;for(var g=0,f=p.length;g<f;g++){var _=p[g];"airport"==_.type?u.push('<a href="javascript:;" data-xy="'+_.position+'">'+_.name+"</a>"):"station"==_.type&&h.push('<a href="javascript:;" data-xy="'+_.position+'">'+_.name+"</a>")}u.length?(r.show(),i.show(),i.html(u.join(o))):(r.hide(),i.hide()),h.length?(c.show(),n.show(),n.html(h.join(o))):(c.hide(),n.hide())}else a.hasTrafficHub=!1}})},queryAround:function(){function e(e){t("#J_aroundType").html(e),t.ajax("/Domestic/Tool/AjaxGetArroundHotels.aspx?hotelid="+p.hotel.id+"&city="+n+"&checkin="+c+"&checkout="+d,{method:"GET",onsuccess:function(o,s){var i=p.addUID(t.parseJSON(s)||[]),r=t.tmpl.render(k,{list:i});if(J.html(i.length||0),C[0].className="around_list hotel_list",C.html(r),b.show(),f.reset(!0),f.clearPOIMarkers(),i.length){var n=[];i.each(function(e,a){var o=e.location.lng+"|"+e.location.lat;e.location=g.setLngLat(o),n.push(e.location);var s=e.index,i=t(t("#J_aroundList .name .around_hotel")[s]).attr("href");t(t("#J_aroundList .name .around_hotel")[s]).attr("href",i+"#ctm_ref=hod_dl_map_ htllst_n_"+s)}),p.bindMouseoverAndMouseout();var c={type:"complete",info:"ok",poiList:{pois:i}};f.drawPOIMarkers(c,"hotel"),clearTimeout(a),a=setTimeout(function(){f.autoZoom(n)},100)}else y.show(),y.find("span.b").html(e)},onerror:function(){J.html(0),C.html(""),b.show(),y.show(),y.find("span.b").html(e)}})}function r(e,t,a,o,s,i){T.keyword=e,T.lngLat=t,T.type=a,p.queryPoi(e,t,a,o,s,i,!0)}var n,c,d,l,u,h,p=this,g=this.CMap,f=p.popAMap,_=t("#J_startPoint"),m=t("#J_endPoint"),v=t("#J_aroundBox"),b=t("#J_aroundTitle"),y=t("#J_noResultSpot"),C=t("#J_aroundList"),J=t("#J_aroundNum"),w=t("#J_aroundPage"),M=t("#J_aroundListType"),S=t("#J_aroundDistance"),k=t("#J_aroundHotelTpl").html(),A=t("#J_aroundBack, #J_routeBack"),x=t("#J_aroundSearch"),L=t("#J_routeSearch"),I=t("#J_rounteSearchIPad"),P=t("#J_aroundListBox, #J_routeSearchBox, #J_noRoute, #J_tooClose, #J_startAndEnd"),T={};this.C.query?(n=this.C.query.cityId,c=this.C.query.checkIn,d=this.C.query.checkOut):(n=this.C.city.id,c=t("#checkIn").value(),d=t("#checkOut").value()),A.bind(s,function(){A.hide(),P.hide(),x.show(),o?(I.show(),L.hide()):L.show(),_[0].blur(),m[0].blur(),v[0].className.indexOf("_selected")!=-1&&"J_routeBack"===this.id?t(h).trigger(s):(v[0].className="around_box",p.hasTrafficHub&&t("#J_trafficHub").show(),p.sgeocode=[],p.egeocode=[{formattedAddress:p.hotel.fullname,location:p.toLngLat(p.hotel.pos,"|")}],_.value(""),m.value(p.hotel.fullname),t("#J_routeWay .selected").removeClass("selected"),t('#J_routeWay a[data-way="transfer"]').addClass("selected"),t(".car_sort .selected").removeClass("selected"),t(".bus_sort .selected").removeClass("selected"),t('.bus_sort a[data-policy="LEAST_TIME"]').addClass("selected")),f.reset(!0),f.CMap.cMapObject.mapObj.clearOverlays&&f.CMap.cMapObject.mapObj.clearOverlays(),f.centerMarker.setMap(),g.setCenter(f.centerMarker.getPosition())}),v.find("a").bind(s,function(a){a.stop();var o=this.getAttribute("data-type");if(!v.hasClass(o+"_selected")||void 0===a.which){h=this;var s=p.sideHeight;u=this.getAttribute("data-subtype");var n=t(this).text();if(l=o,v[0].className="around_box "+o+"_selected",t("#J_aroundBack").css("display","inline"),t("#J_trafficHub, #J_routeSearch").hide(),t("#J_aroundListBox").show(),I.hide(),y.hide(),u){for(var c=u.split("|"),d=[],g=0;g<c.length;g++)d.push('<a href="javascript:;" data-type="'+c[g]+'">'+c[g]+"</a>");M.html('<a href="javascript:;" class="selected" data-type="'+n+'">全部</a>|'+d.join("|")),M.show(),C.css("height",s-i-12-M.offset().height+"px"),M.hide()}else C.css("height",s-i+"px"),M.hide();switch(w.hide(),b.hide(),C.html('<div class="map_pop_loading">加载中...</div>'),o){case"hotel":e(n);break;case"metro":case"sight":case"market":case"restaurant":case"entertainment":r(n,p.toLngLat(p.hotel.pos,"|"),l,u,1,5e3)}}}),M.bind(s,function(e){var t=e.target;if("A"===t.tagName){e.stop();var a=t.getAttribute("data-type");M.find(".selected").removeClass("selected"),t.className="selected",r(a,p.toLngLat(p.hotel.pos,"|"),l,u,1,5e3)}}),w.bind(s,function(e){var a=e.target;if("A"==a.tagName){e.stop();var o=S.attr("data-distance");switch(a.className){case"c_page_mini_current":break;case"c_page_mini_previous":var s=w.find(".c_page_mini_current").html();if(1!=s){var i=Number(s)-1;p.queryPoi(T.keyword,T.lngLat,T.type,u,i,o,!0)}break;case"c_page_mini_next":var s=w.find(".c_page_mini_current").html();if(s!=Math.ceil(J.html()/10)){var i=Number(s)+1;p.queryPoi(T.keyword,T.lngLat,T.type,u,i,o,!0)}break;default:var i=t(a).html();p.queryPoi(T.keyword,T.lngLat,T.type,u,i,o,!0)}}})},displayCircleAndMoniter:function(e,t,a,o,s,i){var r=this,n=e,c=t,d=a,l=o,u=r.popAMap.addCircle(r.hotel.pos,{radius:i,dragstart:function(){},dragend:function(){var e=Math.round(this.getRadius()/1.15);r.queryPoi(n,c,d,l,1,e,!1)},dragging:function(){r.popAMap.moniter.update(u.getDragger(),t)}});r.circle=u,r.popAMap.addDistanceMoniter(t,u.getDragger()),r.displayCircleAndMoniter=function(e,t,a,o,s,i){var h=r.popAMap;n=e,c=t,d=a,l=o,h.moniter.restore(),u.setMap(),h.resetCircle(i,t),u.show(),h.moniter.show()}},bindMouseoverAndMouseout:function(){var e=this,a=t("#J_aroundList");a.find(".around_item").bind("mouseenter",function(){var a=t(this);a.addClass("item_hover");var o=a.attr("data-uid");e.popAMap.poi.highlight(o)}).bind("mouseleave",function(a){var o=t(this),s=e.popAMap.poi,i=o.attr("data-uid");s.isActive(i)||(s.highlight(i,!0),o.removeClass("item_hover"))})},queryPoi:function(e,o,s,i,r,n,c){var d=this,l=d.CMap,u=d.popAMap,h=t("#J_aroundOtherTpl").html(),p=t("#J_aroundNum"),g=t("#J_aroundTitle"),f=t("#J_aroundType"),_=t("#J_aroundList"),m=t("#J_noResultSpot"),v=t("#J_aroundDistance"),b=t("#J_aroundPage"),y=t("#J_aroundListType");d.queryPoi=function(e,o,s,i,r,n,c){l.addService("PlaceSearch",function(l){l.create({city:d.curGeocode,onSearchSuccess:function(l){if(g.show(),f.html(e),v.html(Math.round(n/100)/10),v.attr("data-distance",n),u.clearPOIMarkers(),"metro"===s&&!function(e){var t,a,o,s,i,r,n,c;for(n=0;n<e.length;n++){for(t=e[n],a=t.name,o=t.address.split(";"),i=t.type.split(";"),r=i[1],c=0;c<o.length;c++)s=o[c],o[c]=s.replace("地铁","");a=a.replace("(地铁站)","站("+o.join("/")+")"),t.name=a}}(l.poiList.pois),"ok"!==l.info.toLowerCase())m.show(),m.find("span.b").html(e),p.html(0),_.html("");else{m.hide();var C=l.poiList,J=d.addUID(d.insertionSort(C.pois,"distance"));if(c&&J.length){var w=J[J.length-1].distance;d.displayCircleAndMoniter(e,o,s,i,r,w>200?w:200)}p.html(C.count),C.count>10?(b.show(),d.paging(r,Math.ceil(C.count/10),b[0])):b.hide(),i&&y.show();var M=t.tmpl.render(h,{list:J});_[0].className="around_list "+s+"_list",_.html(M),d.bindMouseoverAndMouseout(),l.poiList.pois=J,u.drawPOIMarkers(l,s),clearTimeout(a),a=setTimeout(function(){u.autoZoom()},100)}}}),l.setPageIndex(r),l.searchNearby(e,o,n)})},d.queryPoi(e,o,s,i,r,n,c)},routeSwitch:function(){function e(e){var t=this.value;t.length>0?r.addService("Autocomplete",function(a){a.create({city:i.curGeocode,onSearchSuccess:function(a){var o=a.tips;if(o){for(var s=[],i=0,r=o.length;i<r;i++){var n=o[i].location,a=e+"|"+o[i].name+"|"+o[i].adcode+(n?"|"+[n.lng,n.lat].join(","):"");s.push('<div class="item" data="'+a+'"><span class="name">'+o[i].name.replace(t,'<span class="b">'+t+"</span>")+'</span><span class="adress">'+o[i].district+"</span></div>")}"start"===e?g.onReady(s.join("")):f.onReady(s.join(""))}}}),a.search(t)}):"start"===e?g.onReady(""):f.onReady("")}function a(e,o,s){var n="string"==typeof e?e:e.getAttribute("data"),l=n.split("|"),u=l[0],h=l[1],p=l[2],g=l[3];g&&(g=g.split(","),g={lng:Number(g[0]),lat:Number(g[1])}),"start"===u?c.value(h):d.value(h),r.addService("Geocoder",function(e){e.create({city:i.curGeocode}),t.BizMod.Promise(function(e){r.addService("PlaceSearch",function(t){t.create({city:i.curGeocode,onSearchSuccess:function(t){if("ok"===t.info.toLowerCase()&&t.poiList.pois.length){for(var i,r,n=t.poiList.pois,c=0,d=n.length;c<d&&g;c++)if(n[c].location.lng===g.lng&&n[c].location.lat===g.lat){i=n[c];break}if(!i&&(i=n[0]),r=[{addressComponent:"",formattedAddress:i.address,location:i.location,adcode:p||"",level:""}],i.address&&i.location&&i.location.lng&&i.location.lat)e.resolve(r);else if(!s||h.indexOf(s)>=0)e.reject();else{var l=u+"|"+s+h+"|"+p+"|"+g;a(l,o)}}else if(!s||h.indexOf(s)>=0)e.reject();else{var l=u+"|"+s+h+"|"+p+"|"+g;a(l,o)}}}),t.search(h.replace(/\(|\)/g,""))})}).then(function(t){e.getAddress(t[0].location,function(e,a){a||(t[0].addressComponent=e.regeocode.addressComponent,t[0].formattedAddress=e.regeocode.formattedAddress),"start"===u?i.sgeocode=t:i.egeocode=t,o&&o()},p)})["catch"](function(){console&&console.warn&&console.warn(h+"placesearch 联想失败"),e.getLocation(h.replace(/\(|\)/g,""),function(e,t){"start"===u?i.sgeocode=e.geocodes:i.egeocode=e.geocodes,o&&o()},p)})})}function o(e,a,o){u.css({display:"","background-color":"#F5F3EF"}),t("#J_routeSearchBox, #J_tooClose").hide();for(var s="",r=0,n=o.length;r<n;r++)s+='<div class="list_item" onmouseover="this.className=\'list_item item_hover\'" onmouseout="this.className=\'list_item\'" onclick="selectGeocode(\''+e+"', '"+o[r].formattedAddress+"', "+r+')"><span class="num">'+(r+1)+'</span><p class="name">'+o[r].formattedAddress+'</p><p class="adress">'+o[r].addressComponent.province+o[r].addressComponent.city+o[r].addressComponent.district+"</p></div>";var c="";switch(o.length){case 0:c='<span class="ico_'+e+'"></span><p class="place">抱歉，在'+i.cityName+'没有找到与<span class="b">“'+a+'”</span>相关的地点。</p><div class="tips"><p class="txt">您还可以:</p><p class="txt">- 检查输入的文字是否有误</p><p class="txt">- 尝试更换不同的文字</p></div>';break;default:c='<span class="ico_'+e+'"></span><p class="place"><span class="b">你是不是要找？</span></p><div class="rec_list">'+s+"</div>"}u.html('<div class="route">'+c+"</div>")}var i=this,r=this.CMap,n=t("#J_routeWay"),c=t("#J_startPoint"),d=t("#J_endPoint"),l=t("#J_routeSearchBtn"),u=t("#J_startAndEnd"),h=t("#J_routeBack"),p=t("#J_aroundSearch, #J_trafficHub, #J_rounteSearchIPad");l.bind(s,function(){if(c.value()&&d.value())if(p.hide(),h.css("display","inline"),1===i.sgeocode.length&&1===i.egeocode.length){var e=n.find(".selected").attr("data-way");i.routeSearch(e,i.sgeocode[0].location,i.egeocode[0].location,i.sgeocode[0].formattedAddress,i.egeocode[0].formattedAddress)}else i.sgeocode.length?i.sgeocode.length>1&&o("start",c.value(),i.sgeocode):a("start|"+c.value()+"|"+i.curGeocode,function(){1===i.sgeocode.length&&1===i.egeocode.length?l.trigger(s):o("start",c.value(),i.sgeocode)},i.cityName),i.egeocode.length?i.egeocode.length>1&&o("end",d.value(),i.egeocode):a("end|"+d.value()+"|"+i.curGeocode,function(){1===i.sgeocode.length&&1===i.egeocode.length?l.trigger(s):o("end",d.value(),i.egeocode)},i.cityName)}),n.find("a").bind(s,function(e){e.stop(),n.find(".selected").removeClass("selected"),t(this).addClass("selected"),t(".car_sort .selected").removeClass("selected"),t(".bus_sort .selected").removeClass("selected"),t('.bus_sort a[data-policy="LEAST_TIME"]').addClass("selected"),l.trigger(s)}),t("#J_changeBus").bind(s,function(e){e.stop(),n.find(".selected").removeClass("selected"),n.find('a[data-way="transfer"]').addClass("selected"),l.trigger(s)}),t("#J_orWalking").bind(s,function(e){e.stop(),n.find(".selected").removeClass("selected"),n.find('a[data-way="walking"]').addClass("selected"),l.trigger(s)}),t("#J_changeStartEnd").bind(s,function(e){e.stop();var t=c.value();c.value(d.value()),d.value(t),t=i.sgeocode,i.sgeocode=i.egeocode,i.egeocode=t,l.trigger(s)}),t(".car_sort").bind(s,function(e){var a=e.target;"A"===a.tagName&&(e.stop(),t(".car_sort .selected").removeClass("selected"),t(a).addClass("selected"),l.trigger(s))}),t(".bus_sort").bind(s,function(e){var a=e.target;"A"===a.tagName&&(e.stop(),t(".bus_sort .selected").removeClass("selected"),t(a).addClass("selected"),l.trigger(s))}),t("#J_aroundList").bind(s,function(e){var a=e.target,o=a.getAttribute("data-way");if(o){e.stop();var s=t.parseJSON(a.parentNode.getAttribute("data-poi"));(CtripHotelMap.mapSupplier="B")&&(s.pos=i.CMap.setLngLat(s.pos),s.pos=[s.pos.lng,s.pos.lat].join("|")),t("#J_aroundListBox").hide(),i.endRoute(o,s.name,s.pos)}}),i.startRoute=function(e,a,o){var r=o.split("|");t("#J_routeWay .selected").removeClass("selected"),t('#J_routeWay a[data-way="'+e+'"]').addClass("selected"),i.egeocode=[{formattedAddress:a,location:i.toLngLat({lng:Number(r[0]),lat:Number(r[1])})}],i.sgeocode=[{formattedAddress:i.hotel.fullname,location:i.toLngLat(i.hotel.pos,"|")}],c.value(i.hotel.fullname),d.value(a),l.trigger(s)},i.endRoute=function(e,a,o){var r=o.split("|");t("#J_routeWay .selected").removeClass("selected"),t('#J_routeWay a[data-way="'+e+'"]').addClass("selected"),i.egeocode=[{formattedAddress:a,location:i.toLngLat({lng:Number(r[0]),lat:Number(r[1])})}],i.sgeocode=[{formattedAddress:i.hotel.fullname,location:i.toLngLat(i.hotel.pos,"|")}],c.value(i.hotel.fullname),d.value(a),l.trigger(s)},t("#J_airportItem, #J_stationItem").bind(s,function(e){var t=e.target,a=t.getAttribute("data-xy");"A"===t.tagName&&a&&(e.stop(),"B"===CtripHotelMap.mapSupplier&&(a=i.CMap.setLngLat(a.replace(",","|")),a=a.lng+","+a.lat),i.endRoute("transfer",t.innerHTML,a.replace(",","|")))});var g=new t.Autocomplete({inputCDom:c,itemClass:"item",hoverClass:"item_hover",divClass:"side_input_pop",onChange:function(){i.sgeocode=[],e.call(this,"start")},onSelection:a}),f=new t.Autocomplete({inputCDom:d,itemClass:"item",hoverClass:"item_hover",divClass:"side_input_pop",onChange:function(){i.egeocode=[],e.call(this,"end")},onSelection:a});window.selectGeocode=function(e,t,a){"start"===e?(i.sgeocode=[i.sgeocode[a]],c.value(t)):(i.egeocode=[i.egeocode[a]],d.value(t)),u.hide(),l.trigger(s)}},routeSearch:function(e,a,o,i,n){function c(){var e=t(".bus_sort .selected").attr("data-policy");f.addService("Transfer",function(a){a.create({city:decodeURIComponent(g.curGeocode),policy:a.getPolicy(e),onSearchSuccess:function(a){if("ok"!==a.info.toLowerCase())return k.hide(),void(f.getDistance(v,b)<1e3?w.show():J.show());var o=a.plans;"LEAST_TIME"==e&&(o=g.insertionSort(o,"time"));var i=k.find(".bus_route_height");i.html("");for(var r=0,n=o.length;r<n;r++){for(var c=o[r],d=c.segments,l=[],h='<div class="route_detail"><span class="ico_start"></span><p class="place_start">'+y+"</p></div>",_=0;_<d.length;_++){var m,M=d[_];switch(M.transit_mode){case"BUS":m="ico_bus";break;case"WALK":m="ico_foot";break;case"SUBWAY":m="m_default"}h+='<div class="route_detail" data-index="'+_+'"><span class="'+m+'"></span><p>'+M.instruction+"</p></div>","WALK"!==M.transit_mode&&l.push('<span class="bus_stop">'+M.transit.lines[0].name.replace(/\(.*\)/,"")+"</span>")}h+='<div class="route_detail"><span class="ico_end"></span><p class="place_end">'+C+"</p></div>";var S=Math.floor(c.time/3600),A=S>0?S+"小时":"",x='<div class="bus_route_box"><table class="route_table" data-index="'+r+'"><tr><th>'+(r+1)+'</th><td><p class="route_pass">'+l.join("&gt;")+'</p><p class="total"><a class="print" href="javascript:;">打印</a>全程约 '+A+Math.floor(c.time%3600/60)+"分 "+c.distance/1e3+'公里</p></td></tr></table><div class="route_detail_box"><div class="route_detail_box2">'+h+"</div></div></div>";i.append(g.html2dom(x))}i.firstChild().addClass("show_route"),u(a,"transfer");var L=t(".bus_route_box");i.find(".route_table").bind(s,function(o){var s=o.target,r=0,n=t(this).parentNode(),c=this.getAttribute("data-index");if("A"===s.tagName&&"print"===s.className)o.stop(),g.printRouter("transfer",e,c);else{if(n.hasClass("show_route"))return;t(".bus_route_box.show_route").removeClass("show_route"),n.addClass("show_route");for(var d=0;d<c;d++)r+=parseInt(t(L[d]).offset().height)+10;i[0].scrollTop=r,u(a,"transfer",c)}}),p(i)}}),a.search(v,b)})}function d(){var e=t(".car_sort .selected").attr("data-policy");f.addService("Driving",function(t){t.create({onSearchSuccess:function(e,t){t?h(e,"walking"):h(e,"driving")}}),t.setPolicy(e),t.search(v,b)})}function l(){f.addService("Walking",function(e){e.create({onSearchSuccess:function(e,t){t?h(e,"walking"):h(e,"walking")}}),e.search(v,b)})}function u(e,a,o){function s(){if("driving"===a||"walking"===a){window.Instance=_.CMap.cMapObject.ifmWin.Instance;var s=_.CMap.cMapObject.mapObj;s.clearOverlays(),s.enableScrollWheelZoom(),s.enableContinuousZoom();var r=_.CMap.cMapObject.BMap,n=new r.Point(e.start.point.lng,e.start.point.lat),c=new r.Point(e.end.point.lng,e.end.point.lat),d=t(".car_sort .selected").attr("data-policy"),l={map:s,autoViewport:!0,panel:"c_result",enableDragging:!0,highlightMode:_.CMap.cMapObject.ifmWin.BMAP_HIGHLIGHT_ROUTE},u=function(){var e=t(".route_detail_box"),a=_.CMap.cMapObject.ifmWin.document.getElementById("c_result");e.html(a.innerHTML),e.find("h1").remove(),e.find(".navtrans-view").remove(),e.find("tr").bind("click",function(){t(".navtrans-table tr[onclick]").each(function(e,a){t(e).find("td").css("background-color","white")}),t(this).find("td").css("background-color","#ABCDEF")})};if("driving"===a){var h=new r.DrivingRoute(s,{renderOptions:l,policy:d,onPolylinesSet:function(e){e&&e.length&&(e[0].getPolyline().setStrokeColor("blue"),e[0].getPolyline().setStrokeOpacity(.5),e[0].getPolyline().setStrokeWeight(7))}});h.search(n,c),h.setResultsHtmlSetCallback(u)}else if("walking"===a){var p=new r.WalkingRoute(s,{renderOptions:l,onPolylinesSet:function(e){e&&e.length&&(e[0].getPolyline().setStrokeColor("#18a52a"),e[0].getPolyline().setStrokeOpacity(.7),e[0].getPolyline().setStrokeWeight(7),e[0].getPolyline().setStrokeStyle("solid"))}});p.search(n,c),p.setResultsHtmlSetCallback(u)}}else _.drawRouter(e,t.BizMod.Router[i[a]],o)}g.circle&&g.circle.remove(),_.moniter&&_.moniter.hide(),_.CMap.cMapObject.mapObj.clearOverlays&&_.CMap.cMapObject.mapObj.clearOverlays(),_.clearRouter(),_.clearPOIMarkers(),_.centerMarker.remove(),"ok"!==e.info.toLowerCase()&&(e.origin||(e.origin=g.sgeocode[0].location),e.destination||(e.destination=g.egeocode[0].location));var i={driving:"DRIVE",walking:"WALK",transfer:"BUS"};"T"===IsGAT?"T"===IsOpenBaiDuMapFlgForGAT?s():_.drawRouter(e,t.BizMod.Router[i[a]],o):"T"===IsOpenBaiDuMapFlg?s():_.drawRouter(e,t.BizMod.Router[i[a]],o)}function h(e,a){if("ok"!==e.info.toLowerCase())return k.hide(),void J.show();var o,s=e.routes[0];if("walking"===a)I.find(".distance").html(s.distance<1e3?s.distance+"米":Math.round(s.distance/100)/10+"公里"),o=T;else{x.find(".distance").html(s.distance<1e3?s.distance+"米":Math.round(s.distance/100)/10+"公里");var i=t("#J_taxiCost");e.taxi_cost>0?(i.show(),i.find(".tolls").html(e.taxi_cost)):i.hide(),o=P}if(u(e,a),"T"===IsGAT){if("T"===IsOpenBaiDuMapFlgForGAT&&("driving"===a||"walking"===a))return}else if("T"===IsOpenBaiDuMapFlg&&("driving"===a||"walking"===a))return;for(var r=s.steps,n='<div class="route_detail"><span class="ico_start"></span><p class="place_start">'+y+"</p></div>",c=0,d=r.length;c<d;c++){var l="";n+='<div class="route_detail" data-index="'+c+'"><!--<span class="'+l+'"></span>--><p>'+r[c].instruction+"</p></div>"}n+='<div class="route_detail"><span class="ico_end"></span><p class="place_end">'+C+"</p></div>",o.html(n),p(o)}function p(e){var a;e.find(".route_detail").bind("mouseover",function(){var e=this.getAttribute("data-index");null!==e&&t(this).find("p").addClass("hover")}).bind("mouseout",function(){var e=this.getAttribute("data-index");null!==e&&t(this).find("p").removeClass("hover")}).bind(s,function(){var o=this.getAttribute("data-index");null!==o&&(e.find(".selected").removeClass("selected"),t(this).find("p").addClass("selected"),g.popAMap.router.openStep(o),g.popAMap.highlightRouterStep(a,!0),a=o,g.popAMap.highlightRouterStep(o))})}var g=this,f=this.CMap,_=this.popAMap,m=e,v=a,b=o,y=i,C=n,J=t("#J_noRoute"),w=t("#J_tooClose"),M=t("#J_routeBack"),S=t("#J_routeSearch"),k=t("#J_routeSearchBox"),A=t(".route_result"),x=t(".car_route_result"),L=t(".bus_route_result"),I=t(".foot_route_result"),P=x.find(".route_detail_box"),T=I.find(".route_detail_box"),j=t(".bus_route_height"),N=t("#J_trafficHub, #J_aroundSearch, #J_aroundListBox, #J_startAndEnd"),B='<div class="map_pop_loading">加载中...</div>';x.find(".print").bind(s,function(){var e=t(".car_sort a.selected").attr("data-policy");g.printRouter("driving",e)}),I.find(".print").bind(s,function(){g.printRouter("walking")}),g.routeSearch=function(e,a,o,s,i){switch(m=e,v=a,b=o,y=s,C=i,N.hide(),J.hide(),w.hide(),A.hide(),S.show(),k.show(),t("#J_routeWay .selected").removeClass("selected"),t('#J_routeWay a[data-way="'+e+'"]').addClass("selected"),M.css("display","inline"),e){case"driving":x.show(),P.css("height",g.sideHeight-360-r+"px"),P.html(B),d();break;case"walking":I.show(),T.css("height",g.sideHeight-310-r+"px"),T.html(B),l();break;case"transfer":L.show(),j.css("height",g.sideHeight-284-r+"px"),j.html(B),c()}},g.routeSearch(e,a,o,i,n)},printRouter:function(a,o,s){var i=this,r={cityId:e.DomesticCityId,cityName:i.cityName,cityCode:i.curGeocode,routeType:a,origin:{name:i.sgeocode[0].formattedAddress,position:i.sgeocode[0].location.lng+"|"+i.sgeocode[0].location.lat},destination:{name:i.egeocode[0].formattedAddress,position:i.egeocode[0].location.lng+"|"+i.egeocode[0].location.lat}};o&&(r.policy=o),s&&(r.index=s);var n=document.createElement("form");n.action="/domestic/MapRoutePrint.aspx",n.target="_blank",n.method="get",document.body.appendChild(n);var c=document.createElement("input");c.type="hidden",c.name="params",c.value=encodeURIComponent(escape(t.stringifyJSON(r))),n.appendChild(c),n.submit(),document.body.removeChild(n)},addUID:function(e){for(var t=this.popAMap.CMap,a=0,o=e.length;a<o;a++)e[a].uid=t.getUID.call(t);return e},foldSide:function(){var e=this,a=this.popAMap,o=t("#J_foldBtn"),i=t("#J_mapSide"),r=t(".map_marker_box");o.bind(s,function(){o.hasClass("btn_side_close")?(o.removeClass("btn_side_close").addClass("btn_side_open"),i.addClass("map_side_hidden"),r.css("right","9px"),a.resizeMap(a.options.width+281,e.sideHeight)):(o.removeClass("btn_side_open").addClass("btn_side_close"),i.removeClass("map_side_hidden"),r.css("right","290px"),a.resizeMap(a.options.width,e.sideHeight))})},html2dom:function(e){var t=document.createDocumentFragment(),a=document.createElement("div");a.innerHTML=e;for(var o=a.children;o.length>0;)t.appendChild(o[0]);return t},insertionSort:function(e,t){if(!e)return e;var a,o,s,i=e.length;for(o=0;o<i;o++){for(a=e[o],s=o-1;s>-1&&Number(e[s][t])>Number(a[t]);s--)e[s+1]=e[s];e[s+1]=a}return e},paging:function(e,t,a){var o,s=1,e=Number(e),i='<span class="c_page_ellipsis">...</span>',r='<a class="c_page_mini_previous" href="javascript:void(0);">&lt;-</a>',n='<a class="c_page_mini_next" href="javascript:void(0);">-&gt;</a>',c="";if(t>5){c='<a class="c_page_mini_current" href="javascript:void(0);">'+e+"</a>";var d=e-1;for(o=0;o<2&&d>0;o++,d--)c='<a href="javascript:void(0);">'+d+"</a>"+c,s++;var l=e+1;for(o=0;o<2&&l<=t;o++,l++)c=c+'<a href="javascript:void(0);">'+l+"</a>",s++;if(s<5)if(d>0)for(o=0;o<5-s;o++,d--)c='<a href="javascript:void(0);">'+d+"</a>"+c;else for(o=0;o<5-s;o++,l++)c=c+'<a href="javascript:void(0);">'+l+"</a>";1==d&&(c='<a href="javascript:void(0);">'+d+"</a>"+c),t-l==0&&(c=c+'<a href="javascript:void(0);">'+l+"</a>"),d>=2&&(c='<a href="javascript:void(0);">1</a>'+i+c),t-l>=1&&(c=c+i+'<a href="javascript:void(0);">'+t+"</a>")}else for(o=1;o<=t;o++)c+=o==e?'<a class="c_page_mini_current" href="javascript:void(0);">'+o+"</a>":'<a href="javascript:void(0);">'+o+"</a>";a.innerHTML=r+c+n}};e.CtripHotelMap.popSide=n}(window,cQuery);
!function(t,e,s){"use strict";function n(t){this.options=i({onMessage:o,onSend:o},t),this.target=t.target,this._sender=function(t,e,s){var n=c?s.postMessage:s.__postMessage;n.call(s,t,e)},!c&&this._fake(),this._listen()}var o=function(){},i=t.extend,a=s.postMessage,c=a&&"function"==typeof a,r=function(t){var e=Object.prototype.toString.call(t);return"[object global]"==e||"[object Window]"==e||"[object DOMWindow]"==e||"setInterval"in t};n.prototype={constructor:n,send:function(t,e){var s=e||this.target,n=r(s),o=n?s:s.contentWindow;return this._sender(t,n?s.location.href:s.getAttribute("src"),o),this},_fake:function(){var t=this;s.__postMessage=function(e){t.options.onMessage.call(t,e)}},_listen:function(){var e=this,n=e.options.onMessage;e.__message=function(t){n.call(e,t.data)},t(s).bind("message",e.__message)},destroy:function(){t(s).unbind("message",this.__message)}},e.PostMessage=n}(cQuery,cQuery.BizMod,window);
!function(t,e){function i(e,i,n){c?e.attachEvent("on"+i,n):t(e).bind(i,n)}function n(e,i,n){c?e.detachEvent("on"+i,n):t(e).unbind(i,n)}function o(t){this.options=r({onOpen:a,onReady:a,onClose:a},t)}var r=t.extend,s=t.browser,a=function(){},u=e.document,c=s.isIE6||s.isIE7||s.isIE8,d=t.browser.isIPad?"touchend":"mouseup",f=function(t){var e=null;try{e=t.contentWindow}catch(i){}return e};o.prototype={_init:function(){t("body").bind(d,function(){setTimeout(function(){o.resize()},0)})},_createIframe:function(){var t=u.createElement("iframe");return t.setAttribute("scrolling","no",!1),t.setAttribute("frameborder","no",!1),t.setAttribute("id","J_fastBook"),t.setAttribute("width","100%"),this.iframe=t,t},resize:function(){var t=this.iframe,e=f(t);e&&t.setAttribute("height",e.document.body.offsetHeight+20)},open:function(n,o){var r,s,a=this;this.currentWrap!==n&&(n.appendChild(this._createIframe()),r=this.iframe,s=f(r),this.__resize=function(){setTimeout(function(){a.resize()},50)},this.__iframeLoaded=function(i){var n=i||e.event,o=n.target||n.srcElement;a.resize(),t(f(o).document.body).bind(d,a.__resize),a.options.onReady.call(a)},r.setAttribute("src",o),i(r,"load",a.__iframeLoaded),this.currentWrap=n,this.options.onOpen.call(this))},close:function(e){var e=e||this.iframe,i=e&&f(e),o=i&&i.document,r=this;this.__resize&&o&&(n(e,"load",r.__iframeLoaded),t(f(e).document.body).unbind(d,r.__resize),delete this.__resize),e&&t(e).remove(),this.currentWrap=null,r.options.onClose.call(r)}},t.BizMod.FastBook=o}(cQuery,window);
cQuery.myFn={refresh:function(e,n,r){if(null!=e){var t=$.parseJSON(e);if(null!=t){var i=t.needRedirect,d=t.redirectUrl;if("true"==i)if("reload"==n)window.location.reload();else if("post"==n){var l=document.getElementById("mainbody"),a=document.createElement("form");if(a.method="POST",a.action=d,null!=r)for(var o in r){var u=document.createElement("input");u.type="hidden",u.name=o,u.value=r[o],a.appendChild(u)}l.appendChild(a),a.submit()}else if("get"==n)return window.location.href=d,!0}}}};
function expand(r){if("string"!=typeof r)return"";for(var n=r.indexOf("@"),t=r.substring(0,n),e=r.substring(n+1),i=new Array,s=t.split("`"),f=0;f<s.length;f++){var l=s[f].split("#");i[l[0]]=l[1]}for(var u="",a="",f=0;f<e.length;f++)u+=e[f],null!=i[u]&&(a+=i[u],u="");return a}
function DoFavHotel(e,t,a,o){if(hotelDomesticConfig.hasLogin){$("#favSpan").click();var i=e;t=t||window.event,t&&(i=t.target||t.srcElement);var n=e.getAttribute("city")?e.getAttribute("city"):$("#cityId").value(),r=i.dataset?i.dataset.id:i.getAttribute("data-id"),s=i.getAttribute("data-favid"),l=n,d="D";d=a?a:i.dataset?i.dataset.type:i.getAttribute("data-type"),"I"==d&&App.setHotelPyramidTrace(r,"fav"),d&&r&&s&&$.ajax("/Domestic/Tool/AjaxGetHotelAddtionalInfo.ashx?favData=1&browseData=1&from=1&cityId="+l+"&type="+d+"&hotelId="+r+"&hotelidlist="+r+"&favid="+s,{cache:!1,onsuccess:function(e,t){if(""!=t&&"-1"!=t){var a=$.parseJSON(t);if($("#favSpan").html("酒店收藏("+(a.AllFavCount||0)+")"),$("#divMyFavHotels").remove(),$(".my_record").append($.BizMod.Util.htmlToDom($.tmpl.render($("#J_favHotel").html(),a.HotelFavList))),a&&void 0!=a.IsFavList){var o=$.parseJSON(a.IsFavList);if(o&&o.length>0&&o[0][r]){var n=null;n="A"!==i.tagName.toUpperCase()||"ico_unfavorite"!=i.className&&"ico_favorite"!=i.className?$("#fav"+r).parentNode():$(i.parentNode),n.find("a.ico_unfavorite").remove(),n.find("a.ico_favorite").remove(),n.html(n.html()+o[0][r])}}var s=$("#divMyFavHotels");$("#favSpan");"I"===d&&customFavAnimate(n,s)}}})}else __SSO_booking_1(e.id,0);return t&&(t.preventDefault?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1),!1}function DealSaleLogin(e){var t=e.id;document.getElementById("__SSO_iframe_0")&&(document.getElementById("__SSO_iframe_0").src="/Domestic/LoginCheck.aspx?a="+t+"&t=0&b=C6023559E1443B966993539FA4A1C272")}function __SSO_submit(e,t){var a=document.getElementById(e);if("iframelogin"==e)return void fastbookSender.send("getCoupon");if(e.match(/fastbook/i))return hotelDomesticConfig.hasLogin=!0,void $("#"+e)[0].click();if(a)if(e.match(/(fav)/i)){hotelDomesticConfig.hasLogin="T";try{DoFavHotel(a,void 0,"","T")}catch(o){}location.reload()}else if(e.match(/(dealsalelogin)/i))fm.action=window.location.href.split("#")[0]+"#"+a.getAttribute("hotel-id"),fm.__VIEWSTATE&&(fm.__VIEWSTATE.name="NOVIEWSTATE"),fm.submit();else if(e.match(/(ulogin)/i)){hotelDomesticConfig.hasLogin="T";try{DoFavHotel(a,void 0,"","T")}catch(o){}location.reload()}else if(e.match(/(commentGrabOff)/i))commentGrabOff.jumpPageJudge();else if(e.match(/(memberRoomType)/i))location.reload();else if(e.match(/(LoginForCoupon)/i))location.reload();else if(e.match(/(J_makeOrder)/i))App.callSuccessAuthStatus(e);else{if(e.match(/(J_MeetingCustomization)/i))return hotelDomesticConfig.hasLogin=!0,void $("#"+e)[0].click();hotelDomesticConfig.hasLogin=!0;var i,n,r,s,l,d,c,p,u,h,m,f,v;a.dataset?(i=a.dataset.hotel,n=a.dataset.room,r=a.dataset.payment,s=a.dataset.brev,l=a.dataset.minstate,d=a.dataset.promotetype,c=a.dataset.startdate,p=a.dataset.depdate,u=a.dataset.requesttravelmoney,h=a.dataset.usefg,m=a.dataset.ctmref,f=a.dataset.swid,v=a.dataset.sctx):(i=a.getAttribute("data-hotel"),n=a.getAttribute("data-room"),r=a.getAttribute("data-payment"),s=a.getAttribute("data-brev"),l=a.getAttribute("data-minstate"),d=a.getAttribute("data-promotetype"),c=a.getAttribute("data-startdate"),p=a.getAttribute("data-depdate"),u=a.getAttribute("data-requesttravelmoney"),h=a.getAttribute("data-usefg"),m=a.getAttribute("data-ctmref"),f=a.getAttribute("data-swid"),v=a.getAttribute("data-sctx")),window.HotelRoom.onOrderButtonClick(i,n,r,s,l,d,c,p,u,h,a,m,f,v)}}function goNextDInfo(e){var t=$(e),a=t.parentNode().find(".btn_prev"),o=t.parentNode().find(".J_EveryDayScroll"),i=o.find("li").length,n=o.attr("cindex");return n>=i?void t.addClass("hidden"):(n++,o.attr("cindex",n),n>1&&a.removeClass("hidden"),n==i&&t.addClass("hidden"),void $.mod.load("animate","1.0",function(){o.animate({marginLeft:"-=624"})}))}function goPrevDInfo(e){var t=$(e),a=t.parentNode().find(".btn_next"),o=t.parentNode().find(".J_EveryDayScroll"),i=o.find("li").length,n=o.attr("cindex");return n<=1?void t.addClass("hidden"):(n--,o.attr("cindex",n),1==n&&t.addClass("hidden"),n<i&&a.removeClass("hidden"),void $.mod.load("animate","1.0",function(){o.animate({marginLeft:"+=624"})}))}var commentGrabOff=function(){function e(e,t,a,o){cQuery.ajax(e,{method:t,context:a,onsuccess:function(e){var e=$.parseJSON(e.responseText);e&&o&&"function"==typeof o&&o(e)}})}function t(t){e("/domestic/tool/AjaxGetUserOrderId.aspx?hotelid="+o,"GET","",function(e){e.url?location.href=e.url:__SSO_loginShow_1(t,!0,"0",!0)})}function a(e){function a(){e.bind("click",function(){var e=$(this).attr("id");o=e.split("_")[1],window.hotelDomesticConfig.hasLogin?t(e):window.__SSO_booking_1(e,0)})}a()}var o,i=$.BizMod.Util;i.htmlToDom;return{construct:a,jumpPageJudge:t}}();$(".commentGrabOff").length&&commentGrabOff.construct($(".commentGrabOff")),window.searchMaiDian={version:"",destination:"",destination_input:"",property_dstn:"",keyword:"",keyword_input:"",property_kwd:"",keyword_type:"",prepageid:"",isothercity:"",rank_kwd:"",rank_dstn:""},window.associationMatchMaiDian={destination:"",keyword:"",ismatch_dstn:"",ismatch_kyw:"",target:""};var App={isCloseBtn:function(e){var t=e.parentNode(),a=e.hasClass("c_close");return a&&t.addClass("hidden"),a},floater:null,sortFloater:null,fliterFloater:null},hideCls="hidden",NOOP=function(){};"undefined"==typeof window.__bfi&&(window.__bfi=[]),$.fn.parent=function(e){e=e.slice(1);for(var t=this[0].parentNode;t&&(!t.className||!$(t).hasClass(e))&&9!=t.nodeType;)t=t.parentNode;return t||document};var HotelFilter=new MadCat(function(){this.init=function(){this.bindEvents(),this.PriceRange($("#priceRange")),$("#btn_range").bind("mousedown",function(){var e=document.getElementById("priceRange").getElementsByTagName("input"),t=0|e[0].value,a=e[1].value,o="";if(""===a)o=""==t?"":"v"+parseInt(t,10);else{var i=Math.min(t,a),n=Math.max(t,a);e[0].value=i,e[1].value=n,o="v"+i+"v"+n}var r={};r.price="v0v0"==o?"":o;var s=$("#priceRange").find(".J_fakeLabel");if(s.length)s.attr("data-value",o),s.attr("id","price-"+o);else{var l=document.createElement("label");l.setAttribute("data-type","price"),l.setAttribute("data-value",o),l.setAttribute("id","price-"+o),l.setAttribute("class","J_fakeLabel"),l.style.display="none",$(l).appendTo($("#priceRange"))}App.update(r),0==t&&0==a&&(e[0].value="",e[1].value=""),$("#priceRange").removeClass("sort_range_hover")})},this.set=function(){},this.PriceRange=function(e){function t(e){e=e||window.event;var t=e.keyCode||e.charCode;13==t&&(e.preventDefault?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1)}function a(){e[0].className="sort_range_hover c_sort_range",r=setInterval(i.bind(this),100)}function o(){clearInterval(r),i.apply(this),n()}function i(){this.value&&"button"!=this.type&&(/^\d+$/.test(this.value)||(this.value=this.value.replace(/[^0-9]+/,"")),0==this.value.indexOf("0")&&this.value.length>1&&(this.value=this.value.substr(1)))}function n(){e[0].className="c_sort_range"}var r=0,s=e.find("input");s.bind("focus",a).bind("blur",o).bind("keydown",t),e.bind("click",function(e){e=e||window.event,e.preventDefault?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1}),e.find(".c_close").bind("click",function(){n()})},this.bindEvents=function(){"use strict";function e(e,t){var a=o.test(e.type)||i.test(e.nodeName.toLocaleLowerCase())?e.parentNode:e;return a.dataset?a.dataset[t]:a.getAttribute("data-"+t)}function t(e,t,a){""===App.formData[t]||void 0===App.formData[t]?e[t]=a:e[t]=(App.formData[t]+(","+a)).split(",").unique().join(",")}function a(){App.floater&&App.floater.reset(),App.mapFloater&&App.mapFloater.reset(),App.sortFloater&&App.sortFloater.reset(),App.fliterFloater&&App.fliterFloater.reset()}var o=/^(?:checkbox|radio)$/i,i=/^(?:span|i)$/i,n=/^(?:label|a)$/i;$("#J_ShowMoreFliter").bind("click",function(e){window.scrollTo(0,0),$("#J_ShowMoreFliter").hide()}),$("#searchForm").bind("click",function(i){if(void 0!==App.formData){var r=i.target;$(r).hasClass("txt")||$(r).hasClass("txt_rate")?r=r.parentNode:$(r).hasClass("rate_highlight")&&(r=r.parentNode.parentNode);var s=this,l=r.nodeName.toLowerCase(),d=r.parentNode.nodeName.toLocaleLowerCase(),c=r.type,p=e(r,"targetel"),u=e(r,"dopost"),h=e(r,"type"),m=e(r,"value"),f={},v=$(o.test(r.type)?r.parentNode:r),_=$("#searchForm").offset().height;if(!n.test(l)||"cl"!==h){i.stopPropagation(),!o.test(c)&&i.preventDefault();var g="i"===l?v.parentNode():v;g.hasClass("J_moreBrand")?(g.addClass("hidden").parentNode().addClass("sta-all").find(".J_lessBrand").removeClass("hidden"),a()):g.hasClass("J_lessBrand")&&(g.addClass("hidden").parentNode().removeClass("sta-all").find(".J_moreBrand").removeClass("hidden"),a());var b="i"===l?v.parentNode():v;if(b.hasClass("J_moreFeature")?(b.addClass("hidden").parentNode().addClass("sta-all").find(".J_lessFeature").removeClass("hidden"),a()):b.hasClass("J_lessFeature")&&(b.addClass("hidden").parentNode().removeClass("sta-all").find(".J_moreFeature").removeClass("hidden"),a()),v.hasClass("J_slideToggle")){v.attr("slidetrigger").split("|").each(function(e){var t=$(s).find("div[data-type="+e+"]").get(0);t.style.display="none"==t.style.display?"block":"none"});for(var w,y=$(s).find(".filter_item"),C=y.length;C--;C>=0)"none"!=y[C].style.display&&(w&&$(y[C]).removeClass("filter_item_last"),w||$(w=y[C]).addClass("filter_item_last"));$(".J_slideToggle").each(function(e){var e=e.get(0);e.style.display="none"==e.style.display?"inline-block":"none"}),a()}if((n.test(l)||o.test(c)&&n.test(d))&&"T"===u&&null==p&&!/disabled/.test(v[0].className)){if(v.hasClass("filter_item_unlimited")){var A=h.split("|");"array"===$.type(A)&&A.each(function(e){"price"==e&&$("#priceRange").find('input[type="text"]').value(""),"brand"==e&&$(".J_brandTab").removeClass("select"),f[e]=""})}else if(v.hasClass("select"))f[h]=App.formData[h].split(",").filter(function(e){return e!==m}).join(",");else if("sl"===h||"l"===h||"s"===h||"location"===h)f.zone="",f.sl="",f.l="",f.s="",f.location="",f[h]=m;else if("type"===h||"brand"===h||"group"===h){var k=(App.formData.group||"").split(","),x=(App.formData.brand||"").split(","),D=[],T=[];if("type"===h)$(".J_brandfilter").find("label[data-brandtype="+m+"]").each(function(e){var t=e.attr("data-type"),a=e.attr("data-value");"group"===t?D.push(a):"brand"===t&&T.push(a)}),t(f,"type",m),f.group=k.filter(function(e){return D.indexOf(e)<0}).join(","),f.brand=x.filter(function(e){return T.indexOf(e)<0}).join(",");else{var N=e(r,"brandtype");f.type=(App.formData.type||"").split(",").filter(function(e){return e!==N}).join(","),t(f,h,m)}}else if("price"===h){var S=[m];$(".price_item input:checked").each(function(e){S.push(e.parentNode().attr("data-value"))}),f.price=S.unique().join(","),$("#priceRange").find('input[type="text"]').value("")}else t(f,h,m),"zone"===h&&(f.sl="",f.l="",f.s="",f.location=""),App.currentFilterType=h;f.page=1,f.attachDistance=0,App.update(f),App.isCptResearch=!1,"star"===h&&(App.isCptResearch=!0);var M=$(".J_moreLandMarks.current").attr("data-mark-type"),I=App.formData.zone?App.formData.zone:App.formData.sl?App.formData.sl:App.formData.s?App.formData.s:App.formData.l?App.formData.l:App.formData.location,J=App.formData.price,O=App.formData.star,H=App.formData.feature,E=App.formData.group,h=App.formData.type,L=$("#htl_search_result_subsituation"),F="pageid="+$("#page_id").value()+';subselect ={"subselect": [{"postype": "'+M+'"},{"position": "'+I+'"},{"price": "'+J+'"},{"star": "'+O+'"},{"special": "'+H+'" },{"brandtype": "'+h+'"},{"brand": "'+E+'"}]}；others=';L.value(F),window.__bfi.push(["_tracklog",L.attr("data-key"),F])}var P=$("#searchForm").offset().height-_;App.floater&&(App.floater._startPos+=P),App.mapFloater&&(App.mapFloater._startPos+=P),App.sortFloater&&(App.sortFloater._startPos+=P)}}}),$("#J_filter").bind("click",function(t){if(void 0!==App.formData){var a=t.target,o=a.nodeName.toLowerCase(),r=$("#hotelStar"),s=a.parentNode.nodeName.toLocaleLowerCase(),l=e(a,"targetel"),d=e(a,"dopost"),c=e(a,"type"),p=e(a,"value"),u={};if(t.stop(),(/clear_all/.test(a.className)||i.test(o)&&n.test(s)||n.test(o))&&"T"===d&&null!=l){if(/clear_all/.test(a.className))$("#J_clearAll").find("a").each(function(t){var a=e(t.get(0),"targetel"),o=a.split("-")[0],i=$("#searchForm").find("#"+a),n=i.find('input[type="checkbox"]').get(0);i.removeClass("select"),n&&(n.checked=!1),u[o]="",$("#priceRange").find('input[type="text"]').value("")}),$("#J_clearAll").html(""),$(a).hide(),r.value("");else{var h=e(a,"targetel"),c=h.split("-")[0],p=h.split("-")[1],m=$("#searchForm").find("#"+h),f=m.find('input[type="checkbox"]').get(0);"star"==c&&r.value(""),u[c]=App.formData[c].split(",").filter(function(e){return e!==p}).join(","),m.removeClass("select"),f&&(f.checked=!1);$(n.test(o)?a:a.parentNode);$("#priceRange").find("#"+h).length&&$("#priceRange").find('input[type="text"]').value("")}u.page=1,u.attachDistance=0,App.update(u)}}}),$("#J_room_tense .close").bind("click",function(){$("#J_room_tense").css("display","none")}),$("#J_sortBox").bind("click",function(t){if(void 0!==App.formData){var t=t||window.event,a=t.target||t.srcElement,r=a.nodeName.toLowerCase(),s=a.parentNode.nodeName.toLocaleLowerCase(),l=a.type;"input"!==r.toLowerCase()&&(t.preventDefault?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1);var d=e(a,"dopost"),c=e(a,"type"),p=e(a,"value"),u=e(a,"ordertype"),h={},m=$(o.test(a.type)||i.test(a.nodeName.toLocaleLowerCase())?a.parentNode:a);if((n.test(r)||o.test(l)&&n.test(s)||i.test(r)&&n.test(s))&&"T"===d){if("orderby"===c){h[c]=parseInt(p),h.ordertype=parseInt(null!=u?1==u?0:1:0);var f=$("#htl_search_result_order"),v="pageid="+$("#page_id").value()+";ordertype="+h[c]+";others="+h.ordertype;f.value(v),window.__bfi.push(["_tracklog",f.attr("data-key"),v])}else if("a"===c){var _=m.find('input[type="checkbox"]').get(0);m.hasClass("selected")?(m.removeClass("selected"),_.checked=!1):(m.addClass("selected"),_.checked=!0);var g=$("#J_sortBox").find("label.selected"),b=0;g.each(function(t){b+=parseInt(e(t.get(0),"value"))}),h[c]=b;var w=$("#J_sortBox ul li"),y={};y.confirm=w.find("label[data-value=16] input").length&&w.find("label[data-value=16] input")[0].checked?1:0,y.bka=w.find("label[data-value=8] input").length&&w.find("label[data-value=8] input")[0].checked?1:0,y.pr=w.find("label[data-value=1] input").length&&w.find("label[data-value=1] input")[0].checked?1:0,y.pre=w.find("label[data-value=6] input").length&&w.find("label[data-value=6] input")[0].checked?1:0,y.timerm=w.find("label[data-value=64] input").length&&w.find("label[data-value=64] input")[0].checked?1:0,y.flash=w.find("label[data-value=128] input").length&&w.find("label[data-value=128] input")[0].checked?1:0,window.__bfi.push(["_tracklog","htl.list.seladd",$.stringifyJSON(y)])}else if("priceInfo"===c){h[c]=parseInt(p);var C=$("#ubt_price_key").value(),A=2===h[c]?"before":"after",k=parseInt($(".J_priceInfo .selected").attr("data-value"),10);window.__bfi.push(["_tracklog",C,"pageid="+$("#page_id").value()+";cityid="+$("#cityId").value()+";cityname="+$("#cityName").value()+";status="+A+";others="]),h[c]!==k&&rtMoneyBobble.hide()}h.page=1,App.update(h)}}}),$("#J_AttachDistance").bind("click",function(t){if(void 0!==App.formData){var t=t||window.event,a=t.target||t.srcElement,r=a.nodeName.toLowerCase(),s=a.parentNode.nodeName.toLocaleLowerCase(),l=a.type;$("#sort_distance");t.preventDefault?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1;var d=e(a,"dopost"),c=e(a,"type"),p=e(a,"value"),u={},h=$(o.test(a.type)||i.test(a.nodeName.toLocaleLowerCase())?a.parentNode:a);(n.test(r)||o.test(l)&&n.test(s)||i.test(r)&&n.test(s))&&"T"===d&&("attachDistance"===c&&(h.parentNode().parentNode().find("a").removeClass("active"),h.addClass("active"),u[c]=parseInt(p)),u.page=1,App.update(u))}}),$(".page_box").bind("click",function(t){if(void 0!==App.formData){var t=t||window.event,a=t.target||t.srcElement,o=a.nodeName.toLowerCase(),i=a.className;t.preventDefault?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1;var r=e(a,"dopost"),s=e(a,"type"),l=e(a,"value"),d={};if("T"===r&&!/disabled/.test(i)){if(/_nocurrent/.test(i))return;if("c_page_submit"===i){var c=$("#txtpage"),p=parseInt(c.value(),10),u=parseInt(c.attr("data-pagecount"),10);d.page=p<=u?p:u}else"c_up"===i?d.page=parseInt(App.formData.page,10)-1:"c_down"===i?d.page=parseInt(App.formData.page,10)+1:n.test(o)&&(d[s]=l);d.showTipFlg=$("#showTipFlg").value(),App.update(d);var h=$("#htl_search_result_pageindex"),m="pageid="+$("#page_id").value()+";pageindex="+d.page+";others=";h.value(m),window.__bfi.push(["_tracklog",h.attr("data-key"),m])}}}),$("#J_zoneBanner,#J_brandBanner").bind("mouseover",function(e){var t=e.target,a=t.nodeName.toLowerCase();"a"===a&&($(t).hasClass("filter_item_unlimited")||$(t).addClass("hover"),$(t).bind("mouseout",function(e){$(this).removeClass("hover")}))}).bind("click",function(e){var t=e.target,a=t.nodeName.toLowerCase();e.preventDefault?e.preventDefault():e.returnValue=!1,"a"!==a||$(t).hasClass("filter_item_unlimited")||($(this).find("a").each(function(e){if(!e.hasClass("filter_item_unlimited")){e.removeClass("current");var t=e.attr("data-target");$("."+t).find(".select").length?e.addClass("select"):e.removeClass("select")}}),$(t).removeClass("select").addClass("current"))}),$(".J_brandTab").bind("mouseover",function(e){$(this).addClass("hover")}).bind("mouseout",function(e){$(this).removeClass("hover")}).bind("click",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,$(".J_brandTab").each(function(e){e.removeClass("current");var t=e.attr("data-target");$("."+t).find(".select").length?e.addClass("select"):e.removeClass("select")}),$(this).removeClass("select").addClass("current");var t=$(this).attr("data-target");$(".J_brandfilter .filter_item_sub:not(.hidden)").addClass("hidden"),$("."+t).removeClass("hidden")})}}),PromInfoBox=function(){var e,t;return{init:function(){e=$("#promInfo_box"),t=e.find(".pop_bd"),e.bind("click",this.onClick.bind(this)),$(document).bind("click",this.dismiss),this.inited=!0},setTitle:function(t){e.find("h3").html(t)},setContent:function(e){e&&e.length?t.html("<ul><li>"+e.join("</li><li>")+"</li></ul>"):t.html("")},show:function(t,a,o){if(e.removeClass("hidden"),t){var i=t.getBoundingClientRect(),n=Math.max(document.documentElement?document.documentElement.scrollLeft:0,document.body?document.body.scrollLeft:0),r=Math.max(document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0);e[0].style.left=i.left+n-100+"px",e[0].style.top=i.top+r+15+"px"}},dismiss:function(){e.addClass("hidden")},onClick:function(e){e=e||window.event;var t=e.target||e.srcElement;return"T"!=t.getAttribute("data-dopost")&&("delete"==t.className&&this.dismiss(),e.preventDefault?e.stopPropagation():e.cancelBubble=!0,void(e.preventDefault?e.preventDefault():e.returnValue=!1))}}}(),VisitorNumber=new MadCat(function(e){this.init=function(){var e=fm.v("vistorCount");"T"==e&&$.ajax(addressUrlConfig.vistorCount,{cache:!1,onsuccess:function(e){}})}},hotelDomesticConfig),scrollObserver,HotelRoom=new MadCat(function(e){function t(t,a){var o=a?t:$($(t).parent(".searchresult_list,.hotel_new_list"));return{index:o.attr("data-index")||"",page:o.attr("data-page")||"",rs:e.isNoResult||""}}var a={};this.reset=function(){a={}},this.onAllRoomButtonClick=function(e,t,o,i){var n=document.getElementById("rl_"+e),r=$("#"+e);a[e]||(a[e]={});var s=a[e],l=s.isShowAll;if($(t).addClass("hidden"),s.inited)l||this.showAllRooms(e,n,null,null,i),r.addClass("show_all_room"),this.switchAllRoomLink(r.find(".searchresult_toggle a")[0],!1);else{var d=new Image;d.src="//pic.c-ctrip.com/common/loading.gif",t.parentNode.appendChild(d),this.showAllRooms(e,n,function(){d.style.display="none",r.addClass("show_all_room"),this.switchAllRoomLink(r.find(".searchresult_toggle a")[0],l)}.bind(this),o,i)}},this.switchAllRoomLink=function(e,t){t?(e.className=e.className.replace("show_fold","show_unfold"),e.innerHTML=roomMessageConfig.allroom[0]):(e.className=e.className.replace("show_unfold","show_fold"),e.innerHTML=roomMessageConfig.allroom[1])},this.onAllRoomLinkClick=function(e,t,o,i,n){var r=document.getElementById("rl_"+e);a[e]||(a[e]={}),window.globalFastBook&&globalFastBook.close();var s=a[e],l=s.isShowAll;if(s.inited){if(l){t.className=t.className.replace("show_fold","show_unfold"),t.innerHTML=o?roomMessageConfig.allroom[2]+o+roomMessageConfig.allroom[3]:roomMessageConfig.allroom[0];var d=t.parentNode.parentNode,c=d.getBoundingClientRect();if(c.top<0){var p=Math.max(document.documentElement?document.documentElement.scrollLeft:0,document.body?document.body.scrollLeft:0),u=Math.max(document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0);window.scrollTo(p,u+c.top)}scrollObserver&&scrollObserver.update($("#"+e))}else if(t.className=t.className.replace("show_unfold","show_fold"),t.innerHTML=roomMessageConfig.allroom[1],s.traceValue){var h=$("#htl_search_result_allroomlist"),m="pageid="+$("#page_id").value()+";hotelid="+e+";clicktime="+(new Date).toFormatString("yyyy-MM-dd hh:mm:ss")+";"+s.traceValue.trim();h.value(m),window.__bfi.push(["_tracklog",h.attr("data-key"),m])}}else{$(t).addClass("hidden");for(var f=t.nextElementSibling||t.nextSibling;f&&1!=f.nodeType;)f=f.nextSibling;$(f).removeClass("hidden")}this.showAllRooms(e,r,function(){t.className=t.className.replace("show_unfold","show_fold"),t.innerHTML=roomMessageConfig.allroom[1];for(var e=t.nextElementSibling||t.nextSibling;e&&1!=e.nodeType;)e=e.nextSibling;$(e).addClass("hidden"),$(t).removeClass("hidden")},i,n)},this.showAllRooms=function(o,i,n,r,s){var l=a[o],d=l.isShowAll,c=$("#"+o);if(l.inited){if(d&&"simple"==e.ViewType)return c.removeClass("show_all_room"),c.find(".all_room_btn").removeClass("hidden"),void(l.isShowAll=!0);if(l.original.find(".J_fastbookWrap").remove(),d?this.swap(i,l.allRooms,l.original):this.swap(i,l.original,l.allRooms),d)for(var p=0,u=l.originalRows.length;p<u;p++){var h=l.originalRows[p];h.isExpanded&&this.clickName(h)}else for(var p=0,u=l.allRoomRows.length;p<u;p++){var h=l.allRoomRows[p];h.isExpanded&&this.clickName(h)}l.isShowAll=!d,scrollObserver&&scrollObserver.update($("#"+o))}else{var m={cache:!0,onsuccess:function(e){var t=e.responseText;if(t){$.myFn.refresh(e.responseText,"post",App.formData),l.isShowAll=!0,s&&(t=t.replace(/("hotel_roompic")/gi,'$1 data-ctm="'+s+'" ')),window.tmpNode.innerHTML=t,l.allRooms=$(window.tmpNode).find("table"),l.allRoomRows=l.allRooms[0].rows,l.original=$(i).find("table"),l.originalRows=l.original[0].rows,this.swap(i,l.original,l.allRooms),n&&n(),l.inited=!0,scrollObserver&&scrollObserver.update($("#"+o)),l.traceValue=$(".htl_search_result_allroomlist_b_value").html();var a=$("#htl_search_result_allroomlist"),r="pageid="+$("#page_id").value()+";hotelid="+o+";clicktime="+(new Date).toFormatString("yyyy-MM-dd hh:mm:ss")+";checkin="+$("#checkIn").value()+";checkout="+$("#checkOut").value()+";"+l.traceValue;a.value(r),window.__bfi.push(["_tracklog",a.attr("data-key"),r]);var d=$(".J_Price_"+o),c=$(".J_NewRMBPrice_"+o);d&&c&&c.html()&&d.html(c.html());var p=$(".J_OriPrice_"+o),u=$(".J_NewOriPrice_"+o);p&&u&&u.html()&&p.html(u.html())}}.bind(this)},f=t(c,!0),v=parseInt(window.getuseridentityresult()),_="&contyped="+v,g="&productcode="+expand($.cookie.get("productcode"));delete App.formData.__VIEWSTATE;var b=hotelDomesticConfig&&hotelDomesticConfig.cas&&hotelDomesticConfig.cas.ret;"number"!==$.type(b)&&(b=2),$.casAjax(addressUrlConfig.allRoom+"hotel="+o+"&"+(r||"")+"&index="+f.index+g+"&page="+f.page+"&rs="+f.rs+"&priceInfo=-1"+_+"&abForHuaZhu="+$("#abForHuaZhu").value(),m)}},this.swap=function(e,t,a){var o=Math.max(t.length,a.length);try{for(var i=0;i<o;i++){var n=t[i],r=a[i];n?r?e.replaceChild(r,n):e.removeChild(n):r&&e.appendChild(r)}}catch(s){}},this.clickName=function(e){var t=e.cells[0].getElementsByTagName("a")[1];(!t||!$(e).hasClass("J_fastbookWrap")&&t.className.indexOf("hotel_room_name")<0)&&(t=e.cells[1].getElementsByTagName("a")[0]),t.onclick()},this.next=function(e){for(var t=e.nextElementSibling||e.nextSibling;t&&1!=t.nodeType;)t=t.nextSibling;return t},this.prev=function(e){for(var t=e.previousElementSibling||e.previousSibling;t&&1!=t.nodeType;)t=t.previousSibling;return t},this.str2Tr=function(e){return window.tmpNode.innerHTML="<table>"+e+"</table>",window.tmpNode.firstChild.rows},this.toggleDetails=function(e,a,o,i,n){var r=[],s=this.next(e);for(n=n||"";s&&($(s).hasClass("J_fastbookWrap")||$(s).hasClass("fixedroom")&&$(s).hasClass("unexpanded"));)$(s).hasClass("unexpanded")&&($(s).hasClass("hidden")?$(s).removeClass("hidden"):$(s).addClass("hidden")),s=this.next(s);if(!s||/\bt\b/.test(s.className)){var l=e.getElementsByTagName("input")[0];if(l&&l.value){if(e.canClick===!1)return;var d=this.str2Tr("<tr><td colspan='"+roomMessageConfig.colspan+"'</td><img style='vertical-align:middle;' src='//pic.ctrip.com/common/loading.gif' />"+roomMessageConfig.loading+"</tr>")[0],c=t(e);e.parentNode.insertBefore(d,s),e.canClick=!1;var p="";o&&"T"==o&&(p="&ishuixuan=T"),delete App.formData.__VIEWSTATE;var u=parseInt(window.getuseridentityresult()),h="&contyped="+u,m="&productcode="+expand($.cookie.get("productcode"));$.ajax(addressUrlConfig.roomInfo+n+"&hotel="+a+m+"&basicRoomId="+l.value+(hotelDomesticConfig.searchSingleRoomParam||"")+"&index="+c.index+"&page="+c.page+"&rs="+c.rs+p+"&RoomIndex="+i+"&priceInfo=-1"+h,{cache:!0,onsuccess:function(t){var a=t.responseText;if(a){$.myFn.refresh(a,"post",App.formData);var o=this.str2Tr(a);o.length>1&&(e.className+=" expandedBaseRoom");for(var i=e.parentNode,n=0,r=o.length-1;n<r;n++)i.insertBefore(o[0],d);if("undefined"==typeof e.isExpanded&&o[0])for(var s=o[0].getElementsByTagName("a"),n=0,r=s.length;n<r;n++){var l=s[n];"link"==l.className&&(l.style.backgroundImage="url("+l.getAttribute("_src")+")")}i.replaceChild(o[0],d),e.isExpanded=!0}}.bind(this)})}}else{for(;s&&/\bunexpanded\b/.test(s.className);)s=this.next(s);for(r.push(s);s&&/\bexpanded\b/.test(s.className);)s=this.next(s),r.push(s);if(e.isExpanded)r.length>1&&e.className.indexOf("fixedroom")<0&&(e.className=e.className.replace(/\bexpandedBaseRoom\b/gi,"")),r.each(function(e){$(e).addClass("hidden")}),e.isExpanded=!1;else{if(r.length>1&&(e.className+=" expandedBaseRoom"),r.each(function(e){$(e).removeClass("hidden")}),"undefined"==typeof e.isExpanded&&r[r.length-1])for(var f=r[r.length-1].getElementsByTagName("a"),v=0,_=f.length;v<_;v++){var g=f[v];"link"==g.className&&(g.style.backgroundImage="url("+g.getAttribute("_src")+")")}e.isExpanded=!0}}},this.hideDetails=function(e){var t=e.parentNode.parentNode.parentNode,a=this.prev(t);for(a&&$(a).hasClass("J_fastbookWrap")&&(a=this.prev(a));a&&(/\bexpanded\b|\bunexpanded\b/.test(a.className)||$(a).hasClass("J_fastbookWrap"));)a=this.prev(a);this.clickName(a)},this.onNameClick=function(e,t,a){var o=e.parentNode.parentNode,i=e.dataset?e.dataset.index:e.getAttribute("data-index"),n=e.dataset?e.dataset.url:e.getAttribute("data-url");this.toggleDetails(o,t,a,i,n),window.globalFastBook&&globalFastBook.close()},this.onOrderButtonClick=function(e,t,a,o,i,n,r,s,l,d,c,p,u,h,m){},this.order=function(e,t,a,o,i,n,r,s,l,d,c,p,u,h){var m={Resource:e,Room:t,Paymentterm:a,BRev:o,Minstate:i,PromoteType:n,PromoteDate:"",StartDate:r,DepDate:s,requestTravelMoney:l,useFG:d,from:"list",swid:p,sctx:u};h&&"ALL"==h.getAttribute("DealSale")?document.getElementById("DealSale").value="ALL":h&&"EDM"==h.getAttribute("DealSale")?document.getElementById("DealSale").value="EDM":h&&"VIP"==h.getAttribute("DealSale")&&(document.getElementById("DealSale").value="VIP"),fm.v(m),fm.action="DELAYORDER"==fm.v("operationtype")?addressUrlConfig.delayOrder:addressUrlConfig.order;var f="";window.location.href.indexOf("ctm_ref=")>0?("detailmapbook"!=c&&(f="&ctm_ref="+window.location.href.slice(window.location.href.indexOf("ctm_ref=")).replace("ctm_ref=","")),fm.action+="?hotelid="+e+f):c?fm.action+="?hotelid="+e+c.replace("#","&")+f:fm.action+="?hotelid="+e,fm.target="_self",fm.submit()},this.onOrderNull=function(e,t){if(e&&t)return MOD.formValidator.method("show",{$obj:$(e),data:t,removeErrorClass:!0,isScroll:!1}),!1},this.onOrderRead=function(e,t){if(e&&t)return MOD.formValidator.method("show",{$obj:$(e),data:t,removeErrorClass:!0,isScroll:!1}),!1},this.PromInfo=function(e){return{render:function(t,a){var o=$.format(roomMessageConfig.prom,"/hotel/"+t+".html",a);PromInfoBox.setTitle(o),PromInfoBox.setContent(e.Recommandprom[t]||[])},show:function(e,t){PromInfoBox.inited||PromInfoBox.init(),this.render(e,t.getAttribute("data-ctm")),PromInfoBox.show(t);var a=window.event||arguments.callee.caller.arguments[0];a.preventDefault?a.stopPropagation():a.cancelBubble=!0}}}(e)},hotelDomesticConfig),AdvertiseScroll=function(){function e(e){this.options=e,this._count=1,this._timer,this._sliding=!1,this._init()}return e.prototype={contructor:e,_init:function(){this._bindEvent()},_bindEvent:function(){var e=this;$.mod.load("animate","1.0",function(){e.options.prev.bind("click",function(){e.pause(),e.prev(),e.autoplay()}),e.options.next.bind("click",function(){e.pause(),e.next(),e.autoplay()}),e.autoplay()})},prev:function(){if(!this._sliding){this._sliding=!0;var e=this,t=this.options.page,a=t.text().split("/"),o=a[1]-0,i=this.options.width;this._count>1?(this.options.slider.animate({marginLeft:"+="+(i-0+2)},function(){e._sliding=!1,e.options.onscroll&&e.options.onscroll(e._count)}),this._count--):(this._count=o,this.options.slider.animate({marginLeft:"-="+(i*(o-1)-0+2)},function(){e._sliding=!1,e.options.onscroll&&e.options.onscroll(e._count)})),t.html(this._count+"/"+o)}},next:function(){if(!this._sliding){this._sliding=!0;var e=this,t=this.options.page,a=t.text().split("/"),o=a[1]-0,i=this.options.width;this._count<o?(this.options.slider.animate({marginLeft:"-="+(i-0+2)},function(){e._sliding=!1,e.options.onscroll&&e.options.onscroll(e._count)}),this._count++):(this._count=1,this.options.slider.animate({marginLeft:"0"},function(){e._sliding=!1,e.options.onscroll&&e.options.onscroll(e._count)})),t.html(this._count+"/"+o)}},autoplay:function(){var e=this;this._timer=setInterval(function(){e.next()},this.options.duration)},pause:function(){clearInterval(this._timer)},reset:function(e){this.pause(),this._count=1,this.options=$.extend(this.options,e),this.autoplay()}},e}();!function(e,t){function a(){this.init()}a.prototype={contructor:a,init:function(a){function o(e,t){if(e.indexOf)return e.indexOf(t);for(var a in e)if(e[a]===t)return a;return-1}var i=this,a=a||addressUrlConfig.ajaxGetCptList,n=[],r=[],s=[];e.ajax(a,{cache:!1,async:!0,onsuccess:function(a){function l(e,t){for(var a=0;a<e.length;a++)return e[a].hotelid-0===t-0?e[a]:null}if(i.hotAdScroller&&clearInterval(i.hotAdScroller._timer),i.recommendAdScroller&&clearInterval(i.recommendAdScroller._timer),i.qualityAdScroller&&clearInterval(i.qualityAdScroller._timer),a&&a.responseText){var d=e.parseJSON(a.responseText);if(d){for(var c=e.parseJSON(HotelMaiDianData.value.htllist),p=0;p<d.advertisinghothotels.length;p++){var u=d.advertisinghothotels[p],h=l(c,u.hotelid);h&&(u.hotelprice=h.amount)}for(var p=0;p<d.advertisingrecommendhotels.length;p++){var u=d.advertisingrecommendhotels[p],h=l(c,u.hotelid);h&&(u.hotelprice=h.amount)}if(d.advertisinghothotels&&d.advertisinghothotels.length){var m=e("#divCptHotHotels");m.html(e.tmpl.render(e("#J_cpt_hotel_hot").html(),{datas:d.advertisinghothotels})).removeClass("hidden");var f={wrap:m,next:m.find(".next"),prev:m.find(".prev"),page:m.find(".hotel_promote_hd .carousel_page .num"),uls:m.find("ul"),slider:m.find(".slider_box_in"),width:m.find("ul:eq(0)").offset().width,duration:5e3,onscroll:function(a){if(!(o(n,a)>=0)){n.push(a);var i=d.hothtlList.filter(function(e){return e.pageindex-0===a-0}),r={hothotels:i};t.__bfi.push(["_tracklog","hotel_inland_list_hothotels_online",e.stringifyJSON(r)]);
}}};e(t).bind("resize",function(){if(App.CPT.hotAdScroller){App.CPT.hotAdScroller.pause();var t=e("#divCptHotHotels").find(".slider_box_in");t.css("marginLeft",0);var a=e("#divCptHotHotels .hotel_promote_hd  .num").text().split("/");e("#divCptHotHotels .hotel_promote_hd  .num").text("1/"+a[1]),App.CPT.hotAdScroller.reset({width:t.find("ul:eq(0)").offset().width,duration:5e3})}}),i.hotAdScroller=new AdvertiseScroll(f)}else e("#divCptHotHotels").addClass("hidden");if(d.advertisingrecommendhotels&&d.advertisingrecommendhotels.length){var m=e("#divCptRecommendHotels");m.html(e.tmpl.render(e("#J_cpt_hotel_recommend").html(),{datas:d.advertisingrecommendhotels})).removeClass("hidden");var v=m.find("ul:eq(0) li:eq(0)"),f={wrap:m,next:m.find(".next"),prev:m.find(".prev"),page:m.find(".other_rec_hd_wrap .carousel_page .num"),uls:m.find("ul"),slider:m.find(".popular_chioce"),width:m.find(".other_rec_bd").offset().width+parseFloat(v.css("marginRight")),duration:5e3,onscroll:function(a){if(!(o(r,a)>=0)){r.push(a);var i=d.recommendhtlList.filter(function(e){return e.pageindex-0===a-0}),n={starrecommend:i};t.__bfi.push(["_tracklog","hotel_inland_list_starrecommend_online",e.stringifyJSON(n)])}}};e(t).bind("resize",function(){if(App.CPT.recommendAdScroller){App.CPT.recommendAdScroller.pause();var t=e("#divCptRecommendHotels").find(".popular_chioce");t.css("marginLeft",0);var a=e("#divCptRecommendHotels .other_rec_hd_wrap  .num").text().split("/");e("#divCptRecommendHotels .other_rec_hd_wrap  .num").text("1/"+a[1]),App.CPT.recommendAdScroller.reset({width:e("#divCptRecommendHotels").find(".other_rec_bd").offset().width+parseFloat(v.css("marginRight")),duration:5e3})}}),i.recommendAdScroller=new AdvertiseScroll(f)}else e("#divCptRecommendHotels").addClass("hidden");if(d.advertisingqualityhotels&&d.advertisingqualityhotels.length){var m=e("#divCptQualityHotels");m.html(e.tmpl.render(e("#J_cpt_hotel_quality").html(),{datas:d.advertisingqualityhotels})).removeClass("hidden");var f={wrap:m,next:m.find(".next"),prev:m.find(".prev"),page:m.find(".hotel_promote_hd .carousel_page .num"),uls:m.find("ul"),slider:m.find(".slider_box_in"),width:m.find("ul:eq(0)").offset().width-2,duration:5e3,onscroll:function(e){o(s,e)>=0||s.push(e)}};e(t).bind("resize",function(){if(App.CPT.qualityAdScroller){App.CPT.qualityAdScroller.pause();var t=e("#divCptQualityHotels").find(".slider_box_in");t.css("marginLeft",0);var a=e("#divCptQualityHotels .hotel_promote_hd  .num").text().split("/");e("#divCptQualityHotels .hotel_promote_hd  .num").text("1/"+a[1]),App.CPT.qualityAdScroller.reset({width:t.find("ul:eq(0)").offset().width-2,duration:5e3})}}),i.qualityAdScroller=new AdvertiseScroll(f)}else e("#divCptQualityHotels").addClass("hidden");d.hothtlList&&d.hothtlList.length&&d.recommendhtlList&&d.recommendhtlList.length||d.hothtlList&&d.hothtlList.length||d.recommendhtlList&&d.recommendhtlList.length}else e("#divCptHotHotels,#divCptRecommendHotels,#divCptQualityHotels").addClass("hidden")}}})}},App.CPT=new a}(cQuery,window);var QueryEngine=function(){function e(){new RegMod({city:$("#txtCity"),startDate:$("#txtCheckIn"),endDate:$("#txtCheckOut"),keyword:$("#txtKeyword"),offsetPos:7});HotelSearch.init(),$("#btnSearch").bind("click",function(e){var t=document.getElementsByTagName("form")[0];HotelSearch.submit()&&(sendAjaxWithKeyword(),t.hotelStar.value="",t.k1.value="",t.k2.value="",App.setFilterValuesToForm(),t.submit());var a=$("#htl_search_result_situation"),o=$("#cityId").value(),i=$("#cityId").value(),n=2==o.split("_").length&&0==o.indexOf("D");n&&(i=o.split("_")[0].substring(1,o.split("_")[0].length),o=o.split("_")[1]);var r="pageid="+$("#page_id").value()+";from="+$("#txtCity").value()+";checkindate="+$("#txtCheckIn").value()+";checkoutdate="+$("#txtCheckOut").value()+";searchkey="+$("#txtKeyword").value()+";cityid="+o+";regionid="+i+";regiontype="+(n?"4":"1")+";others=";a.value(r),window.__bfi.push(["_tracklog",a.attr("data-key"),r]),e.stop()}),$("#btnSearchMapList").bind("click",function(){var e=document.getElementsByTagName("form")[0];HotelSearch.submit(!1,!0)&&(sendAjaxWithKeyword(),e.target="_blank",e.submit())})}function t(){function e(e,t){if(o!==!0){o=!0;var a=window.addressUrlConfig.photoabulm,n=a.replace("$1",e),r=$("#hod_detail_picture");r.attr("data-hotelId",e);var s=$("#"+e+" .J_price_lowList"),l=s.parentNode().attr("href").split("#")[0];$.ajax(n,{cache:!1,onsuccess:function(e){o=!1,e.responseText&&($("#photoabulm").html(e.responseText),$("#J_Pic_LowPrice").html(s.html()),l&&$("#J_Pic_ToDetail").attr("href",l),i.init(),t&&i.show(t))},onerror:function(e){o=!1}})}}function t(e){var t=!1,a=e.split(" ");if(null!=a&&a.length>0)for(var o=0;o<a.length;o++)if(r.indexOf(a[o])>=0){t=!0;break}return t}var a,o=!1,i=$.BizMod.mainPanelModal;$("#J_MeetingCustomization").bind("click",function(e){var e=e||window.event;hotelDomesticConfig.hasLogin||(e.stop(),__SSO_booking_1(this.id,0))});var n=[];$(".J_showViedo").bind("mouseover",function(){var e=e||window.event,t=e.target||e.srcElement,a=$(t).attr("data-poster")||$(t.parentNode).attr("data-poster");if(n.indexOf(a)==-1){n.push(a);var o=document.createElement("img");o.src=a,o.style.width="1px",o.style.height="1px",o.style.overflow="hidden",$(t).append(o)}}),$("#hotel_list").bind("click",function(t){var t=t||window.event,a=t.target||t.srcElement;if(/J_showViedo/.test(a.className)||/J_showViedo/.test(a.parentNode.className)){t.stop();var o=$(a).attr("data-hotel")||$(a.parentNode).attr("data-hotel");e(o,"video")}else if(/J_showVR/.test(a.className)||/J_showVR/.test(a.parentNode.className)){t.stop();var o=$(a).attr("data-hotel")||$(a.parentNode).attr("data-hotel");e(o,"pic360")}else if(1===a.nodeType&&(/hotel_abbrpic|hotel_item_pic/.test(a.className)||/hotel_abbrpic|hotel_item_pic/.test(a.parentNode.className))){t.stop();var i=/hotel_abbrpic/.test(a.className)?$(a):$(a.parentNode);if(i.hasClass("haspic")){var o=i.attr("data-hotel");e(o)}}}).bind("mouseover",function(e){var e=e||window.event,t=e.target||e.srcElement;if(1===t.nodeType&&"img"===t.nodeName.toLocaleLowerCase()&&"hotelpic"===t.name&&!/hotel_pic_big/.test(t.className)){var a=$(t).parentNode();0===a.find(".hotel_pic_big").length&&$($.create("img",{className:"hotel_pic_big",width:300,height:225,src:$(t).attr("data-bigimgsrc")})).appendTo(a)}}),window.tmpNode=document.createElement("div"),window.tmpNode.className="hidden",document.body.appendChild(window.tmpNode),window.fm=document.forms[0],fm&&(window.fm.v=function(){var e=arguments,t=e.length,o=this.elements;if(1==t){if("string"==typeof e[0])return o[e[0]]?o[e[0]].value.trim():null;for(var i in e[0])o[i]?o[i].value=e[0][i]:(a=document.createElement("input"),a.type="hidden",a.name=i,a.value=e[0][i],this.appendChild(a))}else 2==t&&o[e[0]]&&(o[e[0]].value=e[1]);return this}),[HotelFilter,VisitorNumber].each(function(e){e.init()});var r=["hotel_price","searchresult_name","hotel_item_name","hotel_abbrpic","hotel_judge","hotel_abbrpic","hotel_name","hotel_pic","sider_hotel_pic","around_hotel"];$(document).bind("mousedown",function(e){e=e||window.event;var a=e.target||e.srcElement;if("A"!=a.nodeName&&(a=a.parentNode),a&&1==a.nodeType&&"A"==a.nodeName.toUpperCase()){var o=(a.dataset?a.dataset.ctm:a.getAttribute("data-ctm"))||null;if(t(a.parentNode.className)||t(a.className)){var i=null;if(a.getAttribute("data-href")?i=a.getAttribute("data-href"):(a.setAttribute("data-href",a.href),i=a.href),2===e.button){var n=$("#txtCheckIn").value(),r=$("#txtCheckOut").value(),s=[];!/checkIn=/.test(i)&&n&&s.push("checkIn="+n),!/checkOut=/.test(i)&&r&&s.push("checkOut="+r),s.length>0&&(i=i.indexOf("?")>0?i+"&"+s.join("&"):i+"?"+s.join("&"))}o&&!/#ctm_ref=/.test(i)&&(i+=o),a.href=i}else o&&!/#ctm_ref=/.test(a.href)&&(a.href+=o)}}).bind("click",function(e){e=e||window.event;var t,a=e.target||e.srcElement;if(void 0!==e.which?t=3==e.which:void 0!==e.button&&(t=2==e.button),!t&&("A"!=a.nodeName&&(a=a.parentNode),a&&1==a.nodeType&&"A"==a.nodeName)){var o=a.parentNode,i=a.dataset?a.dataset.dopost:a.getAttribute("data-dopost"),n=a.dataset?a.dataset.norecommend:a.getAttribute("data-norecommend"),r=a.href;if("T"==n){var s=a.href.indexOf("?");if(s>=0)r=a.href.substr(0,s)+"?norecommend=T&"+a.href.substr(s+1);else{var l=a.href.indexOf("#");r=l>=0?a.href.substr(0,l)+"?norecommend=T"+a.href.substr(l):a.href+"?norecommend=T"}}if(i){if(o&&null!=o.getAttribute("data-id")){var d=$("#"+o.getAttribute("data-id")+" .hotel_price .J_price_lowList").text();$("#priceLow").value(d),App.setHotelPyramidTrace(o.getAttribute("data-id"))}else $("#priceLow").value("0");var c;o&&(c=o.parentNode)&&("J_locationItems"==c.getAttribute("id")||"hot_htl_city"==c.className)&&setLocationHiddens(a.getAttribute("href"));var p=document.forms[0];"T"==$(a).attr("clearCond")?App.setFilterValuesToForm():App.setFilterValuesToForm(App.formData),p.__VIEWSTATE&&(p.__VIEWSTATE.name="NOVIEWSTATE"),p.action=r,p.target=a.target||"_self",p.submit(),e.preventDefault?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1}}}),$.mod.load("jmp","1.0",function(){$(document).regMod("jmp","1.0",{options:{alignTo:"cursor"}})}),function(e){var t,a,o=e.createElement("div"),i=e.createElement("span"),n=new Image,r=500,s=function(e){return e&&"a"===e.nodeName.toLowerCase()&&$(e).hasClass("link")},l=function(e,t){e.style.position="absolute",e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.zIndex=100},d=function(e,t,a){if(t){var r=e.getAttribute("data-src");n.setAttribute("src",r),$(o).removeClass("hidden"),a&&parseInt(a)>1&&($(i).removeClass("hidden"),setTimeout(function(){$(i).addClass("hidden")},1e3))}else $(i).addClass("hidden"),$(o).addClass("hidden")},c=$.browser.isIPad?"touchstart":"click";o.className="hotel_pic_big2 hidden",n.setAttribute("width",300),n.setAttribute("height",225),i.className="current_img_num",o.appendChild(n),o.appendChild(i),e.body.appendChild(o),$("#hotel_list").bind("mouseover",function(i){if(t=i.target,$(o)[0]){var n=i.clientX+e.body.scrollLeft+e.documentElement.scrollLeft+15,c=i.clientY+e.body.scrollTop+e.documentElement.scrollTop+15;l(o,{x:n,y:c})}if(t&&t.tagName&&"A"===t.tagName.toUpperCase()&&$(t).hasClass("link")){clearTimeout(a);var p=t.parentNode.parentNode,u=parseInt($(p).attr("data-imagecount"))||1,h=parseInt($(p).attr("data-imageIndex"))||1;$(o).find("span").html('<span class="c">'+h+"</span>/"+u),s(t)&&(a=setTimeout(function(){d(t,!0,u)},r))}else d(t,!1,!1)}).bind("mouseout",function(e){t=e.target,clearTimeout(a),d(t,!1,!1)}).bind("mousemove",function(t){var a=t.target;if($(o)[0])if(s(a)){var i=t.clientX+e.body.scrollLeft+e.documentElement.scrollLeft+15,n=t.clientY+e.body.scrollTop+e.documentElement.scrollTop+15;l(o,{x:i,y:n})}else d(a,!1,!1)}).bind(c,function(e){t=e.target;var a,i,n;if("B"===t.tagName.toUpperCase()&&"SPAN"===t.parentNode.tagName.toUpperCase()&&(t=t.parentNode),"SPAN"===t.tagName.toUpperCase()&&"A"===t.parentNode.tagName.toUpperCase()&&(t=t.parentNode),"A"===t.tagName.toUpperCase()&&"btn_next"===t.className&&(e.stop(),a=$(t.previousSibling),i=parseInt(a.attr("data-imageIndex")),n=parseInt(a.attr("data-imagecount")),i+=1,i>1&&i<=n&&(a.attr("data-imageIndex",i),a.find(".img_box").css("left",parseInt(a.find(".img_box").css("left"))-75+"px"),i==n&&$(t).addClass("hidden"),i>1&&a.previousSibling().removeClass("hidden"))),"A"===t.tagName.toUpperCase()&&"btn_preview"===t.className&&(e.stop(),a=$(t.nextSibling),i=parseInt(a.attr("data-imageIndex")),n=parseInt(a.attr("data-imagecount")),i-=1,i>=1&&i<=n&&(a.attr("data-imageIndex",i),a.find(".img_box").css("left",parseInt(a.find(".img_box").css("left"))+75+"px"),1==i&&$(t).addClass("hidden"),i<n&&a.nextSibling().removeClass("hidden"))),s(t)){if(e.stop(),"touchstart"===e.type&&$(o)[0]){var r=$(t).offset(),c=$(t).parentNode().parentNode(),p=parseInt(r.left)+parseInt(r.width)+parseInt(c.nextSibling().offset().width),u=parseInt(r.top),h=parseInt(c.attr("data-imagecount"));l(o,{x:p,y:u}),$(o).find("span").html('<span class="c">'+c.attr("data-imageIndex")+"</span>/"+h),s(t)&&d(t,!0,h),$(o).css({display:"block"})}}else d(t,!1,!1)}),$("#hotel_list").find(".htl_promotion").each(function(e){$(e).regMod("jmp","1.0")})}(document)}function a(){var e=$.BizMod.SearchPanel,t=$.BizMod.Serialize.makeArray($("#hotel_list .searchresult_list,#hotel_list .hotel_new_list")).map(function(e){return $(e).attr("id")}).join(",");e.initAdditionalInfo().init({getListUrl:addressUrlConfig.visitedAndCollectHotelUrl+"&viewCount=4&hotelidlist="+t,removeUrl:"/Domestic/Tool/AjaxDeleteVistedB.aspx",hasLogin:hotelDomesticConfig.hasLogin,onRemove:function(e){var t=$("#visitedHistory");e.parentNode().remove(),0==t.find(".J_historyHotelsList")[0].children.length&&t.html('<div class="no_record">暂无浏览历史</div>')},oncomplete:function(e){e||(e={}),e.HotelFavList||(e.HotelFavList=[]),$(".my_record").append($.BizMod.Util.htmlToDom($.tmpl.render($("#J_favHotel").html(),e.HotelFavList))),e.VisitedHotelInfo||(e.VisitedHotelInfo=[]),$(".my_record").append($.BizMod.Util.htmlToDom($.tmpl.render($("#J_visitedHotel").html(),e.VisitedHotelInfo.slice(0,4))));var t=$("#visitedHistory"),a=t.find("label").html(),o=new Function(a)();window.HistoryMaiDianData=o,window.favMaiDianData=$.parseJSON(e.FavMaiDianData),$("#favSpan").html("酒店收藏("+(e.AllFavCount||0)+")"),scrollObserver&&scrollObserver.updateAll();var i,n=parseInt($.cookie.get("minimap","status")||1,10);i=1===n?2:1,$(".J_historyHotelsList li").length<=i?(t.find(".more").hide(),t.addClass("history_unfold")):t.addClass("history_fold"),$(".my_record_hd span").bind("click",function(){$(this).addClass("current"),"favSpan"===this.id?($("#histSpan").removeClass("current"),window.favMaiDianData&&window.__bfi.push(["_tracklog",window.favMaiDianData.key,$.stringifyJSON(window.favMaiDianData.value)])):($("#favSpan").removeClass("current"),window.HistoryMaiDianData&&window.__bfi.push(["_tracklog",window.HistoryMaiDianData.key,$.stringifyJSON(window.HistoryMaiDianData.value)]));var e=$(this).attr("data-container");$("#"+e).removeClass("hidden"),"divMyFavHotels"===e?$("#visitedHistory").addClass("hidden"):$("#divMyFavHotels").addClass("hidden")}),t.find(".more a").unbind().bind("click",function(){$(this).hasClass("more_fold")?($($(".J_historyHotelsList")[0].parentNode).addClass("history_unfold"),t.find(".more_unfold").show(),window.HistoryMaiDianData.value.ismore="T",window.__bfi.push(["_tracklog",window.HistoryMaiDianData.key,$.stringifyJSON(window.HistoryMaiDianData.value)])):($($(".J_historyHotelsList")[0].parentNode).removeClass("history_unfold"),t.find(".more_fold").show(),window.HistoryMaiDianData.value.ismore="F",window.__bfi.push(["_tracklog",window.HistoryMaiDianData.key,$.stringifyJSON(window.HistoryMaiDianData.value)])),$(this).hide()});var r=$.parseJSON(e.IsFavList);if(r)for(var s=0;s<r.length;s++)for(var l in r[s]){var d="[id=fav{hotelId}]".replace("{hotelId}",l),c=$(d).parentNode();c[0]&&(c.find("a.ico_unfavorite").remove(),c.find("a.ico_favorite").remove(),c.html(c.html()+r[s][l]))}window.moreclick=function(){window.favMaiDianData&&(window.favMaiDianData.value.ismore="T",window.__bfi.push(["_tracklog",window.favMaiDianData.key,$.stringifyJSON(window.favMaiDianData.value)])),window.open("//my.ctrip.com/FavoriteOnline/Hotel/HotelList.aspx")}},deleteBtnCls:"delete"}).getList();var a=hotelDomesticConfig.city.id,o=setTimeout(function(){if(clearTimeout(o),"undefined"==typeof window.HOTEL_POSITION[a]){var e=arguments.callee;return void(o=setTimeout(e,100))}var t="",i={};t.replace(/([^\,]+)(\,|$)/gi,function(e,t){i[t]="1"});for(var n=[],r=[],s=HOTEL_POSITION[a].subCity||[],l=0,d=s.length;l<d;l++){var c=s[l];/D\d+_\d+/.test(c.id)||(i[c.id]||n.push('<a target="_blank" data-dopost="T" href="/hotel/'+c.py+c.id+'" title="'+c.display+'">'+c.display+"</a>"),r.push('<a target="_blank" data-dopost="T" href="/hotel/'+c.py+c.id+'" title="'+c.display+'">'+c.display+"</a>"))}var p=document.getElementById("divNoresult");if(p)if(r.length){var u='<p id="pNoResultSubCity">1. '+noResultMessageConfig[0]+" ";u+=r.join(" "),u+="</p><p>2. "+noResultMessageConfig[1]+"</p>",p.innerHTML+=u}else p.innerHTML+="<p>"+noResultMessageConfig[1]+"</p>"},100)}function o(){$("#delHuixuan").bind("click",function(){document.getElementById("HuiXuan").style.display="none"});var e=document.getElementById("gotop");cQuery.browser.isIE6&&e&&(e.style.position="absolute",$(window).bind("scroll",function(){e.style.top=document.documentElement.scrollTop+document.documentElement.clientHeight/2+"px"})),$("#banner").length&&$("#banner").regMod("allyes","1.0",{mod_allyes_user:"ctrip|CTRIP_HOTEL_HOMEPAGE|HOTEL_BANNER@ctrip|CTRIP_HOTEL_INNERPAGE|HOTEL_INNER_BANNER"}),$(window).bind("load",function(){$(window).trigger("scroll")})}function i(){e(),t(),a(),o(),$("#J_starttime")[0]&&App.hotelPopBindEvents();var i=$("#htl_search_result_hotellist"),n=window.htl_search_result_hotellist_b_value;i.value(n),window.__bfi.push(["_tracklog",i.attr("data-key"),n]);var r=HotelMaiDianData;r.value.loadtime=(new Date).getTime()-new Date(r.value.loadtime).getTime(),r.value.regionid=HotelMaiDianOtherData.regionid,r.value.regiontype=HotelMaiDianOtherData.regiontype,r.value.oid=HotelMaiDianOtherData.oid||"",window.__bfi.push(["_tracklog",r.key,$.stringifyJSON(r.value)])}return{load:i}}();!function(e,t,a){"use strict";var o,i=e.BizMod.Util,n=!1,r=e("#J_hotHotelRank"),s=r.parentNode(),l=e("#hotSale1").length;l||s.css("display","none"),o={load:function(t){var t=i.isFunction(t)?t:NOOP;return n?t():void e.ajax(addressUrlConfig.loadHotSellUrl,{method:e.AJAX_METHOD_GET,onsuccess:function(a,o){var i=e.parseJSON(o);i&&200===i.code&&(n=!0,r[0].innerHTML=i.JsonResult,t()),window.hotHotelList=null==i.HotelIdList?"":i.HotelIdList}})},show:function(){return r.css("display",""),s.css("display",""),o},hide:function(){return l||s.css("display","none"),r.css("display","none"),o}},t.HotRanking=o}(cQuery,App),function(e){function t(e,t,a){this.CMap=e,this.options=t,this.markers={},this.mkrHtml={},e.addPlugin(["ToolBar","OverView","Scale"],function(e,t,o){setTimeout(function(){e.create({direction:!1,ruler:!1,type:3}).addToControl(),t.create().addToControl(),o.create().addToControl(),a.apply(this,arguments)},0)})}function a(){var t=e(".page_box").offset().bottom;return e("body").offset().height-t}function o(t,a,o){var i=scrollObserver||new e.ScrollObserver,n=null;i.unObserve(),i.observe(a),v&&a.unbind("change",v),o?(v=function(e,a){var o=t.getMarker(this.getAttribute("id")),i={};o&&(i={normal:o.isTarget?"map_mark":"spot_htl",hover:o.isTarget?"map_mark_select":"spot_htl_hover"}),o&&(a?t.highlight(o,i).isSingleRecAndActive=!0:t.highlight(o,i,!0).isSingleRecAndActive=!1),n=setTimeout(function(){var e=mapMessageConfig.landmarks,a=e&&e.length&&e.length>1?t.markerArr:null;!a&&t.CMap.autoFit()},100)},a.bind("change",v)):(v=function(e,a){if(!g.hasClass("wrap_main_result")){var o=t.getMarker(this.getAttribute("id"));o&&(a?o.setMap():o.remove()),n&&clearTimeout(n),n=setTimeout(function(){var e=mapMessageConfig.landmarks,a=e&&e.length&&e.length>1?t.markerArr:null;!a&&t.CMap.autoFit()},100)}},a.bind("change",v)),scrollObserver=i}function i(t){var a,o,i=parseInt(e.cookie.get("minimap","status")||1,10),r=c.find(".J_togglemap"),t=t||{},s=d.isFunction(t.expendFn)?t.expendFn:NOOP,l=d.isFunction(t.collaspeFn)?t.collaspeFn:NOOP,p=e("#map_unfold_tracevalue"),u=e("#map_fold_tracevalue"),h=e("#htl_search_result_hotelrecommend");0===i?l(r):n(),new e.BizMod.Toggle({btnActiveCls:"map_unfold",status:i,btn:r,onChange:function(t,i){var n=document.documentElement.scrollTop||document.body.scrollTop,r=document.documentElement.scrollLeft||document.body.scrollLeft;e.cookie.set("minimap","status",i,{expires:100}),0===i?(l(t),a="T",o=p.value()):(s(t),a="F",o=u.value()),window.scrollTo(r,n+1);var d=window.collectHotelList||"",c=window.scanedHotelList||"",m=window.hotHotelList||"",f="pageid="+e("#page_id").value()+";isclickclose="+a+";collecthotellist="+d+";scanedhotellist="+c+";hothotellist="+m+";others=";h.value(f),window.__bfi.push(["_tracklog",h.attr("data-key"),f])}})}function n(){var o={width:h.width+"px",height:h.height+"px"},i=CtripHotelMap.map({el:u[0],width:o.width,height:o.height,map:{resizeEnable:!0,doubleClickZoom:!1,level:10,zooms:[3,17]},iframe:{src:addressUrlConfig.mapIframe,frameBorder:"none",scrolling:"no",cssText:"width:"+o.width+";height:"+o.height+";display:none;border: none;"}});i.makeMap(function(){var o=e("#J_hotelInfoOnMap"),n={x:410,y:20},r={panel:o,panelOffset:n};m=!0,f=i.getCMapObject().ifmWin;var s=new t(i,{tipTpl:e("#J_mapTipTpl").html()},function(){!function(t){var a=null,o=function(){a&&clearTimeout(a),a=setTimeout(function(){var t=e("#J_floatRight").offset(),a=t.width,o=u.offset().height;c.find("iframe").css({width:a+"px",height:o+"px"}),i.setMapSize(a,o),i.autoFit()},100)};l||(e(t).bind("resize",o),o())}(window),s.reloadMap(_,r);var t=a(),o=e("#J_FilterPanel").offset().height,n=e("#J_isFloat"),d=c["float"](p,t,o,function(){this[!g.hasClass("wrap_main_result")&&n[0].checked?"play":"stop"]()},null,e(".page_box")),h=c.find(".side_map")["float"](p,t,0,function(){this[g.hasClass("wrap_main_result")&&n[0].checked?"play":"stop"]()},null,e(".page_box")),m=function(){var t=e(".page_box").offset().bottom,a=g.hasClass("wrap_main_result");t>c.offset().bottom?a?(h[n[0].checked?"play":"stop"](),d.stop()):(d[n[0].checked?"play":"stop"](),h.stop()):(d.stop(),h.stop())};n.bind("click",m),m(),e(window).trigger("scroll"),App.floater=d,App.mapFloater=h,App.fetchCallback=function(){e(window).trigger("resize"),s.reloadMap(BizData.hotelPositionJSON,r),d.setEnd(a()),h.setEnd(a()),m()}})})}function r(t){var a=e(".slider_box_in"),o=e("#visitedHistory"),i=e("#divCptHotHotels .hotel_promote_hd  .num").text().split("/");e("#divCptHotHotels .hotel_promote_hd  .num").text("1/"+i[1]);var n=e("#divCptQualityHotels .hotel_promote_hd  .num").text().split("/");e("#divCptQualityHotels .hotel_promote_hd  .num").text("1/"+n[1]),a.css("marginLeft",0),e(".J_historyHotelsList li").length<=t?o.find(".more").hide():(o.removeClass("history_unfold"),o.find(".more_fold").show(),o.find(".more_unfold").hide()),App.CPT.hotAdScroller&&App.CPT.hotAdScroller.reset({width:e("#divCptHotHotels .slider_box_in").find("ul:eq(0)").offset().width,duration:5e3}),App.CPT.qualityAdScroller&&App.CPT.qualityAdScroller.reset({width:e("#divCptQualityHotels .slider_box_in").find("ul:eq(0)").offset().width-2,duration:5e3})}var s="hidden",l=e.browser.isIE6,d=e.BizMod.Util;t.prototype={constructor:t,html2dom:d.htmlToDom,showTip:function(t,a,o){var i=e.tmpl.render(this.options.tipTpl,a);t.html(i),t.css({left:o.x+"px",zIndex:9999,top:o.y+"px"}),t.removeClass(s)},hideTip:function(e){e.addClass(s)},localToGlobal:function(e,t,a){return{x:e+a.x,y:t+a.y}},clearMarkers:function(){this.CMap.deleteMap(),this.markers={},this.mkrHtml={}},addMarker:function(e,t,a,o,i,n){if(e){var r=this.CMap.addMarker({offset:a,position:e,content:t,zIndex:i?10:5});r._key_=o,this.markers[o]=r,this.mkrHtml[o]=t,n&&n(r)}},addCenterMarker:function(e,t,a,o){var i="CENTERMARKER_"+a,n='<div id="'+i+'" class="landmark_pop"><span class="landmark_pop_cont"><span>'+t+'</span></span><div class="ico_spot"></div></div>',r=this.CMap.addMarker({cpix:"-17|-46",position:e,content:n,zIndex:3});r.mkrId=i,o&&o(r)},initCenterMarker:function(){function e(){return a++,t+"x"+a}var t=+new Date,a=0;return function(t,a){var o=this.CMap;this.addCenterMarker(o.setLngLat(t),a,e(),function(e){var t=e.getContent();e.bindEvent("mouseover",function(){t.className="landmark_pop landmark_pop_hover",e.setzIndex(4)}).bindEvent("mouseout",function(){t.className="landmark_pop",e.setzIndex(3)})})}}(),getMarker:function(e){return this.markers[e]},highlight:function(t,a,o){var i=this;if(o)if(t.isTarget?t.setzIndex(10):t.setzIndex(5),l){var n=i.html2dom(i.mkrHtml[t._key_],f);t.setContent(n)}else e(t.getContent()).removeClass(a.hover);else if(t.setzIndex(100),l){var n=i.html2dom(i.mkrHtml[t._key_],f);n.className=a.normal+" "+a.hover,t.setContent(n)}else e(t.getContent()).addClass(a.hover);return t},reloadMap:function(t,a){var i=this,n=mapMessageConfig.landmarks;this.clearMarkers(),n&&n.length&&n.each(function(e){i.initCenterMarker(e.position,e.name)}),i.markerArr=i.addMarkers(t,a.panel,a.panelOffset),i.CMap.autoFit(i.markerArr),i.unbindHoverEvents(e("#hotel_list > .searchresult_list li h2,#hotel_list > .hotel_new_list li h2")),i.bindHoverEvents(e("#hotel_list > .searchresult_list li h2,#hotel_list > .hotel_new_list li h2")),o(i,e(".searchresult_list,.hotel_new_list"),i.isSingleRec)},addMarkers:function(t,a,o){var i=this,n=!1,r=this.CMap,s=[];if(t||(t=[]),t.each(function(t,l){if(t&&t.lat&&t.lon&&"-1"!=t.lat&&"-1"!=t.lon){var d,p,u,h,m="MAPMARKERS_"+t.id;t.isSingleRec&&"false"!==t.isSingleRec?(d='<div id="'+m+'" class="spot_htl"></div>',p=r.setPixel("-12|-29"),h={normal:"spot_htl",hover:"spot_htl_hover"},n=!0,u=!1):(d='<div id="'+m+'" class="map_mark"><span class="map_num">'+(l+1)+'</span><div class="map_mark_inner"><span style="white-space:nowrap;" class="map_mark_name">'+t.shortName+"</span></div></div>",p=r.setPixel("-17|-40"),h={normal:"map_mark",hover:"map_mark_select"},u=!0),i.addMarker(r.setLngLat(t.lon+"|"+t.lat),d,p,t.id,u,function(n){var d=null;n.bindEvent("mouseover",function(){var s=r.lngLatToContainer(n.getPosition()),l=c.offset();clearTimeout(d),d=setTimeout(function(){if(i.showTip(a,t,{x:l.left+s.x-o.x,y:l.top+s.y-o.y}),i.highlight(n,h),n.isTarget){var r=n.mkrId.split("_")[1];r&&e("#hotel_list").find(".searchresult_name[data-id='"+r+"']").addClass("searchresult_name_hover")}},500)}).bindEvent("mouseout",function(){a.addClass("hidden"),n.isSingleRecAndActive||i.highlight(n,h,!0),clearTimeout(d),n.isTarget&&e("#hotel_list").find(".searchresult_name").removeClass("searchresult_name_hover")}).bindEvent("click",function(){e("#depdate").value(e("#txtCheckOut").value()),e("#startdate").value(e("#txtCheckIn").value()),MOD.globalForm.submit(t.url,"_blank")}),s.push(n),n.index=l,n.mkrId=m,n.isTarget=u})}}),!n)for(var l=0;l<s.length;l++)s[l].remove();return this.isSingleRec=n,s},unbindHoverEvents:function(e){e.unbind("mouseenter",this.__listMouseenterHandler).unbind("mouseleave",this.__listMouseleaveHandler)},bindHoverEvents:function(e){var t=null,a=this,o={};this.__listMouseenterHandler=this.__listMouseenterHandler||function(){var e=a.getMarker(this.getAttribute("data-id"));e&&(t=setTimeout(function(){o.normal=e.isTarget?"map_mark":"spot_htl",o.hover=e.isTarget?"map_mark_select":"spot_htl_hover",a.highlight(e,o),e.shake()},300))},this.__listMouseleaveHandler=this.__listMouseleaveHandler||function(){var e=a.getMarker(this.getAttribute("data-id"));e&&(clearTimeout(t),o.normal=e.isTarget?"map_mark":"spot_htl",o.hover=e.isTarget?"map_mark_select":"spot_htl_hover",a.isSingleRec||a.highlight(e,o,!0))},e.bind("mouseenter",this.__listMouseenterHandler).bind("mouseleave",this.__listMouseleaveHandler)}};var c=e("#J_floatRight"),p=c.offset().top,u=e("#J_minMapWrap"),h=u.offset();window.screen.height<=650&&u.css("height",h.height-40+"px");var m,f,v,_=BizData.hotelPositionJSON,g=e("#J_mainBox");i({collaspeFn:function(t){var o=App.floater,i=App.mapFloater,n=e("#J_isFloat")[0].checked;g.addClass("wrap_main_result"),t.removeClass("map_fold").addClass("map_unfold").html("展开地图<i/>"),o&&o.stop(),o&&(o.stop(),o.reset(),o.setEnd(a())),n&&i&&(i.play(),i.setEnd(a())),App.HotRanking&&App.HotRanking.load(function(){App.HotRanking.show()}),r(1)},expendFn:function(t){var a=(document.documentElement.scrollTop||document.body.scrollTop,e("#searchForm").offset().top,App.floater),o=App.mapFloater,i=e("#J_isFloat")[0].checked;t.removeClass("map_unfold").addClass("map_fold").html("收起地图<i/>"),o&&(o.stop(),o.reset()),i&&a&&a.play(),App.HotRanking&&App.HotRanking.hide(),g.removeClass("wrap_main_result"),App.fetchCallback&&App.fetchCallback(),m||n(),r(2)}})}(cQuery),function(e){var t=e("#div360");if(t[0]){var a=e.browser.isIE6;setTimeout(function(){t[0].style.display="none",a&&e(window).unbind("scroll",o)},1e4);var o=function(){var e=(document.documentElement.scrollTop||document.body.scrollTop)+document.documentElement.clientHeight-76;t.css("top",e)};a&&e(window).bind("scroll",o)}}(cQuery),function(e){var t=e("#divStationContent"),a=e("#positionArea"),o=e("#positionId"),i=e("#hotelAreaName"),n=function(e){return!!e.attr("data-id")};t.length&&t.bind("mousedown",function(t){var r=t.target;n(e(r))&&(a.value(""),o.value(""),i.value(""))})}(cQuery),function($,DOC){function ZoneMap(e){var t={delay:500,showTipEvent:"mouseover",tabSelectedCls:"selected",defaultTab:0,closeCls:".close",onClick:NOOP,onTab:NOOP,onInitView:NOOP,onShow:function(){},onHide:function(){this.wrap.unmask()}};e=Util.mix(t,e),this.options=e,this._viewInited={},this._render(e.tpl,e.data),this._initTab(),this._initView(),this._initCloseBtn()}function initLandmarkManager(e){var t={ZONE:0,STATION:1,METRO:2,LOCATION:3,CIVIL:5},a={},o={},i="hidden";return{getData:function(i,n,r){var s=this,l=a[i];return l&&r?(r(l,!0),s):i===t.ZONE?(l=$(".J_staticBusinessTarget").get(0),$(n).parentNode().parentNode().find("#J_locationHolder").get(0).appendChild(l),a[i]=l,r&&r(l),s):(!o[i]&&(o[i]=!0)&&$.ajax(e.url,{method:"POST",context:s.getParams(i,n),onsuccess:function(e,t){if(t){t=htmlToDom(t);var o="",l=App.formData;l.sl&&""!=l.sl?o="sl":l.location&&""!=l.location?o="location":l.s&&""!=l.s?o="s":l.l&&""!=l.l&&(o="l");var d=$(t).find("#"+o+"-"+l[o]);d.length&&d.addClass("select"),$(n).parentNode().parentNode().find("#J_locationHolder").get(0).appendChild(t),a[i]=t,s._bindEvents(i,"s"==o||"l"==o?parseInt(l.l||0):0),r&&r(t),l.s&&""!=l.s&&(l.l="")}}}),s)},getParams:function(e,t){var a=this,o=e||a.currentType,i={city:a._city,markType:o};return t&&t.attr("data-args")&&(i.args=t.attr("data-args")),i},init:function(){return this},_bindEvents:function(e,o){var i,n=t,r=Array.prototype.slice.apply($("a[data-metroid]")).map(function(e){return parseInt($(e).attr("data-metroid"))}).indexOf(o);switch(e){case n.METRO:var s={options:{tab:"a[data-metroid]",panel:"div.subway_station",trigger:"mouseup",index:r===-1?0:r,save:!1},style:{tab:"current",panel:{display:["block","none"]}}};i=$(a[e]),i.bind("click",function(e){e.preventDefault()}),$.mod.load("tab","1.2",function(){i.regMod("tab","1.2",s)});break;case n.STATION:}},_fixStyle:function(e){},setCity:function(e){return this._city=e,this},typesMap:t,show:function(t,o,n){var r=this;return r._city?(r.getData(t,o,n||function(n,s){var l=$(a[t]);l.data("trigger",o),l.removeClass(i),r.currentType=t,e.onShow.call(r,l,t)}),r):r},hide:function(t){var o=this,n=$(a[t]);return n.length&&(n.addClass(i),e.onHide.call(o,n,t)),o},clear:function(e){void 0!==e?delete a[e]:a={}}}}var NOOP=function(){},Util=$.BizMod.Util,isIPad=$.browser.isIPad,CLICK=isIPad?"touchstart":"click",htmlToDom=Util.htmlToDom,hideCls="hidden";ZoneMap.prototype={constructor:ZoneMap,_render:function(e,t){var a=htmlToDom($.tmpl.render(e,t));this.wrap=$(a),DOC.body.appendChild(a)},_initCloseBtn:function(){var e=this;e.wrap.find(e.options.closeCls).bind(CLICK,function(t){t.stop(),e.hide()})},_initTab:function(){var e=this,t=e.options,a=e.wrap.find(t.tabCls);e._tabs=a,a.bind("click",function(o){var i=$(this),n=a.indexOf(i);e.tabTo(n),t.onTab.call(e,n,i)});var o=parseInt(window.hotelDomesticConfig.istaiwan)>0||!1;o&&a.length>0&&$(a[0]).addClass("hidden")},_initView:function(){var e=this;e._views=e.wrap.find(e.options.viewCls)},_initAreas:function(){var e=this,t=e.options,a=null,o=function(e){return"area"===e.tagName.toLowerCase()},i=e.wrap.find(t.areaWrapCls);e.areasWrap=i,i.bind("mouseover",function(t){var i=t.target;clearTimeout(a),o(i)&&(a=setTimeout(function(){e.showTip($(i))},500))}),i.bind("mouseout",function(t){clearTimeout(a),o(t.target)&&e.closeTip()}),i.bind(CLICK,function(a){var i=a.target;o(i)&&(a.stop(),t.onAreaClick.call(e,a,i))})},tabTo:function(e){var t=this,a=t.options,o=a.dataUrls,i=t._tabs,n=t._views,r=a.tabSelectedCls,s=a.viewSelectedCls,l=t._viewInited[e];l?(i.removeClass(r),n.css({
display:"none"}).removeClass(s),$(i[e]).addClass(r),$(n[e]).css({display:""}).addClass(s)):t._getRemoteData(o[e],a.getParams(),function(o){if($(t._views[e]).html($.tmpl.render(a.viewsTpl[e],o)),t.options.onInitView.call(t,e),t._viewInited[e]=!0,i.removeClass(r),n.css({display:"none"}).removeClass(s),$(i[e]).addClass(r),$(n[e]).css({display:""}).addClass(s),0===e&&t._initAreas(),null!==t.wrap){var l=parseInt(t.wrap.css("height"))+parseInt(t.wrap.css("borderTopWidth"))+parseInt(t.wrap.css("borderBottomWidth")),d=parseInt(document.documentElement.clientHeight||document.body.clientHeight);l<d?t.wrap.css("top",(d-l)/2+"px"):t.wrap.css("top","0px")}})},show:function(){this.wrap.removeClass(hideCls),this.options.onShow.call(this)},hide:function(){this.wrap.addClass(hideCls),this.options.onHide.call(this)},_getRemoteData:function(url,params,callback){$.ajax(url,{method:"POST",context:params,onsuccess:function(response,responseText){var rs=responseText;if(rs){try{rs=eval("("+rs+")")}catch(e){rs={html:rs}}callback&&callback(rs)}}})},_positionTip:function(e,t){var a=e.split(","),o=parseInt(a[0]),i=parseInt(a[1]);o-=120,i>=115?i-=120:i+=70,t.css({position:"absolute",left:o+"px",top:i+"px"})},showTip:function(e,t){var a=this,o=a.options,i=t||$.parseJSON(e.attr("data-tip-data")),n=$(htmlToDom($.tmpl.render(o.tipTpl,i)));n.insertAfter(a.areasWrap),a._positionTip(e.attr("coords"),n),a._currentTip=n},closeTip:function(){var e=this._currentTip;e&&e.remove()}},App.init=function(e){function t(e){var t=0,a=$("#J_locationHolder")[0];if(a){void 0===e?(t=App.formData.markType,e=$("[data-mark-type="+t+"]")):t=parseInt(e.attr("data-mark-type"));var i=$("#cityId").attr("_defaultvalue");$.BizMod.Serialize.makeArray($("#J_locationHolder")[0].childNodes).each(function(e){1===e.nodeType&&$(e).addClass("hidden")}),o.setCity(i).show(t,e),$(".J_moreLandMarks").removeClass("current"),e&&e.addClass("current")}}App.initConfig=e;var a=new ZoneMap({tabCls:"#J_zoneMarksTabs>li",viewCls:".J_zoneMarksTabView",areaWrapCls:"#J_zoneMap",tipTpl:$("#J_zoneTipTpl").html(),tpl:$("#J_zoneMarksTpl").html(),viewsTpl:[$("#J_zoneMapTpl").html(),$("#J_zoneListTpl").html()],dataUrls:e.zoneDataUrls,selectedIndex:0,getParams:function(){return o.getParams()},onAreaClick:function(e,t){var a=t.getAttribute("data-mark-info").split("|"),o=a[1];$("#positionArea").value("Zone"),$("#positionId").value(a[0]),$("#hotelAreaName").value(o),$("#txtKeyword").value(o),$("#btnSearch")[0].click()}}),o=initLandmarkManager({url:e.landmarksAjax,zoneWrap:a.wrap,onShow:function(e,t){this.typesMap.ZONE===t||this.typesMap.CIVIL===t&&window.__bfi.push(["_tracklog","hod_sr_gwyks_lm",this._city.toString()])},onHide:function(e,t){this.typesMap.ZONE===t&&e.unmask()}}).init();$("#J_filter")[$("#J_clearAll").find("a").length?"addClass":"removeClass"]("mt_35");var i=$("#J_FilterPanel").offset().height;App.sortFloater=$("#J_sortBox")["float"](null,null,i),App.fliterFloater=$("#J_FilterPanel")["float"](null,null,null,function(){var e=DOC.documentElement.scrollTop||DOC.body.scrollTop,t=$("#searchForm").offset().height+$("#searchForm").offset().top;e>t?$("#J_ShowMoreFliter").show():$("#J_ShowMoreFliter").hide()},"search_part_fix"),$(".J_moreLandMarks").bind("click",function(e){t($(this))}),t(),!App.formData||""==App.formData.equip&&""==App.formData.feature||$(".hotel_condition_unfold").click(),$(".filter_box").find("input:checked").each(function(e){e.parentNode().hasClass("select")||(e[0].checked=!1)}),$(".filter_box").find(".input_range").each(function(e){var t=e.attr("data-defaultvalue");e.value(t)})}}(cQuery,document),$("#div_hotel > *").bind("click",function(e){e=e||window.event;var t=e.target||e.srcElement;if("A"!=t.nodeName&&(t=t.parentNode),t&&1==t.nodeType&&"A"==t.nodeName){var a,o=t.parentNode;o&&(a=o.parentNode)&&("J_locationItems"==a.getAttribute("id")||"hot_htl_city"==a.className)&&setLocationHiddens(t.getAttribute("href"));var i=document.forms[0];if(t.href.indexOf("inn")>=0)return;i.action=t.href,t.target?i.target=t.target:i.target="_self",i.__VIEWSTATE&&(i.__VIEWSTATE.name="NOVIEWSTATE"),i.submit(),e.preventDefault?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1}}),function(e,t,a){function o(){function t(t,o){var i={type:t,inited:o,env:this};if(r||(r=CtripHotelMap.dialog({obj:document.getElementById("mapDialog"),onChange:function(e,t){if(t)switch(t.type){case"AMap":n(e,t);break;case"SOSO":a(e,t)}else n(e),a(e)}}),e("#J_delMap").bind(p,function(){s&&s.reset(),l&&l.deleteSOSO(),l=null,r.hide()})),o){var d=HotelMapStreetJson[e(this).attr("data-hotelId")];d&&d.soso&&d.soso.pano?m.removeClass("hidden"):(m.addClass("hidden"),g.addClass("hidden"),_.removeClass("hidden"),v.addClass("hidden"),v.removeClass("current"))}u&&(e("#J_mapSide").css("display","none"),e(".map_marker_box").css("display","none")),r.show(i)}function a(t,a){if(a&&i(),a&&a.inited){var o=a.env;w={hotelId:e(o).attr("data-hotelId")}}var n=HotelMapStreetJson[w.hotelId];if(n){var r=cQuery.extend(t,n);if(r.hotelId=w.hotelId,c)l?l.resize(t):l=CtripHotelMap.sosoMap(r);else{var s={type:"text/javascript",async:!0,charset:"utf-8",onload:function(){c=!0,l=CtripHotelMap.sosoMap(r)}};cQuery.loader.js(SOSOMAP_URL,s)}}}function o(){m.removeClass("hidden"),m.removeClass("current"),v.addClass("current"),v.removeClass("hidden"),_.removeClass("hidden"),g.addClass("hidden")}function i(){v.removeClass("hidden"),v.removeClass("current"),m.removeClass("hidden"),m.addClass("current"),_.addClass("hidden"),g.removeClass("hidden")}function n(t,a){if(a&&a.inited){var i=a.env;w={hotelId:e(i).attr("data-hotelId")}}var n=HotelMapStreetJson[w.hotelId];if(a&&n&&n.soso.pano&&o(),n)if(n.amap.id=w.hotelId,d)a?(!u&&CtripHotelMap.popSide.reshow(n.amap),s.addCenterMarker(n.amap.pos,n.amap)):(s.resizeMap(t.w,t.h),CtripHotelMap.popSide.resize(t.h));else{!u&&(t.w-=281);var r={type:"text/javascript",async:!0,charset:"utf-8",onload:function(){CtripHotelMap.popAMap&&(d=!0,s=CtripHotelMap.popAMap({width:t.w,height:t.h,infoWinTpl:e("#J_dotMarkerTpl").html(),mapData:n.amap,mapSide:document.getElementById("J_mapSide"),loading:e("#J_amapLoading"),centerMarkerTpl:e("#J_centerMarkerTpl").html(),circleDragEvents:{dragstart:function(){},dragend:function(e){s.moniter.update(e)},dragging:function(e){s.moniter.update(e)}},onMapReady:function(){!u&&CtripHotelMap.popSide.init(this)},onPOIMouseOver:function(t){var a=t.target,o=a._cUid,i=this.poi;i.highlight(a),!i.isActive(t.target)&&e(a.getContent()).find(".landmarks_click").removeClass(h),e(".around_item[data-uid="+o+"]").addClass("item_hover")},onPOIDeactive:function(t){var a=t.target,o=a._cUid;e(".around_item[data-uid="+o+"]").removeClass("item_hover")},onPOIMouseOut:function(t){var a=t.target,o=a._cUid;this.poi.isActive(a)||(this.poi.highlight(a,!0),e(a.getContent()).find(".landmarks_click").addClass(h),e(".around_item[data-uid="+o+"]").removeClass("item_hover"))},onPOIClick:function(e){}}))}};cQuery.loader.js(POPMAP_URL,r)}}var r=null,s=null,l=null,d=!1,c=!1,p=e.browser.isIPad?"touchstart":"click",u="1"===hotelDomesticConfig.istaiwan,h="hidden",m=e("#J_showSOSO"),f=e(".J_showPopMap,#viewMap, #linkViewMap"),v=e("#J_showAMap"),_=e("#J_mapBox"),g=e("#J_streetBox"),b=e(".J_showPopStreet"),w={};f.bind(p,function(){t.call(this,"AMap",!0)}),b.bind(p,function(){t.call(this,"SOSO",!0),i()}),m.bind(p,function(){t.call(this,"SOSO",!1),i()}),v.bind(p,function(){t.call(this,"AMap",!1)})}App.PopMap=o,new o}(cQuery,this),function(e,t){function a(){var t,a=this,o=e("#J_ForNewUserPopbox");a.judgePopDisplay=function(a,i,n){"1"==a&&i?(clearTimeout(t),t=setTimeout(function(){e.myAjax("/DomesticBook/Tool/AjaxCheckPriceCS.aspx","POST",i,function(e){500==e.code?o.getMask():n()})},500)):n()},a.bindEvent=function(){o.find(".c_close, .J_return").bind("click",function(){o.removeMask()})}}var o,i,n,r,s="fastbook_is_loading",l="fast_book_loading",d='<div class="fast_book_loading"><i></i>给力加载中，请稍后...</div>',c=e.BizMod.Util,p=e.BizMod.PostMessage,u={loaded:function(t,a){i=e("#"+t.hotelId),this.hideLoading(a.parentNode),scrollObserver&&scrollObserver.update(i)},close:function(e,t){this.hideLoading(t.parentNode),h.close()},hideLoading:function(t){e(t).removeClass(s).find("."+l).remove()},showLoading:function(t){var a=e(c.htmlToDom(d));e(t).addClass(s).append(a)},fullOrder:function(t,a){var o=e("#J_fastbook"+t.param.roomId),i=o.parentNode();i.html(e.tmpl.render(e("#J_unOrderTpl").html())),i.find("input").bind("click",function(){window.HotelRoom.onOrderNull(this,"订完")})},fullClose:function(t,a){e(a).parentNode().parentNode().addClass("hidden"),this.close(t,a)}},h=new e.BizMod.FastBook({onReady:function(){var a=this;o=new p({target:a.iframe,onMessage:function(t){t=e.parseJSON(t),u[t.action](t,a.iframe)}}),t.fastbookSender=o},onClose:function(){o&&o.destroy(),i&&i.length?(scrollObserver&&scrollObserver.update(i),i.find(".J_fastbookWrap").remove(),i=null,n&&n.setAttribute("data-open",0),n=null):scrollObserver&&scrollObserver.updateAll()}});t.globalFastBook=h;var m=new a;m.bindEvent(),e("#hotel_list").bind("click",function(a){var o,i,l=a.target,d=l.parentNode;if(d&&1==e(d).attr("data-fastbook")&&(l=d),!(1!=e(l).attr("data-fastbook")||1==e(l).attr("data-fastbook")&&e.browser.isIPad)){a.stop();e(l).attr("data-hotelid"),e(l).attr("data-roomid");m.judgePopDisplay(l.getAttribute("data-GrpHotelFstOrd"),e.proUrlParam(l.getAttribute("href")),function(){if(1!=l.getAttribute("data-open")&&n!==l)if(hotelDomesticConfig.hasLogin)h.close(),r&&r.remove(),o=document.createElement("tr"),o.className="J_fastbookWrap",i=document.createElement("td"),"1"==isNewBookSucessVer?(i.setAttribute("colspan",7,0),o.appendChild(i),e(o).insertAfter(e(l).parentNode().parentNode().parentNode())):(i.setAttribute("colspan",8,0),o.appendChild(i),e(o).insertAfter(e(l).parentNode().parentNode().parentNode())),i.className=s,i.style.overflow="visible",n&&n.setAttribute("data-open",0),u.showLoading(i),h.open(i,l.getAttribute("href").replace("InputNewOrder.aspx","DomeInputNewOrderQuick.aspx")),i.scrollIntoView(),t.scrollBy(0,-78),l.setAttribute("data-open",1),n=l,r=e(o);else{if("true"==e(l).attr("data-isMember"))return e(l).attr("id","memberRoomType_"+e("#hotel_list td a").indexOf(e(l))+parseInt(1e4*Math.random())),void __SSO_loginShow_1(e(l).attr("id"),!0,"0",!0);__SSO_booking(l.getAttribute("id"),"undefined"!=typeof ISSSOQUICKLOGIN?ISSSOQUICKLOGIN:0)}else h.close(),l.setAttribute("data-open",0),n=null,r&&r.remove()})}})}(cQuery,window),function(){function e(e){this.aLinks=$(e.aLinks),this.url=e.url,this.init()}e.prototype={constructor:e,init:function(){this.aLinks.bind("click",this._sendAjax.bind(this))},_resetUrl:function(e,t){var a=this.url;return a.indexOf("{tracekey}")!==-1&&(a=a.replace(/{tracekey}/,e)),a.indexOf("{tracevalue}")!==-1&&(a=a.replace(/{tracevalue}/,t)),a},_sendAjax:function(e){var t=e.target,a=$(t),o=a.attr("tracekey"),i=a.attr("tracevalue"),n=a.attr("tracekey1"),r=a.attr("tracevalue1"),s=a.attr("tracekeyghi"),l=a.attr("tracevalueghi");if(t.tagName&&"A"===t.tagName.toUpperCase()&&(o&&window.__bfi.push(["_tracklog",o,i]),n&&window.__bfi.push(["_tracklog",n,r]),s)){for(var d=l.split(";"),c={},p=0;p<d.length;p++){var u=d[p].split("=");c[u[0]]=u[1]}l=$.stringifyJSON(c),window.__bfi.push(["_tracklog",s,l])}}},new e({aLinks:"#hotel_list",url:window.addressUrlConfig.traceLogUrl})}(),function(e,t){function a(){var t=e(".page_box").offset().bottom;return e("body").offset().height-t}t.customFavAnimate=function(t,a){var o=a.find("ul.sider_pic_list li");if(o.length){var i=this,n=t.find("a").last().offset(),r=o.first().offset(),s=null;if(!e("#animateDom")[0]){var l=document.createElement("div");animateDom=e(l),animateDom.attr("id","animateDom"),animateDom.css({position:"absolute","z-index":5,background:"url(//pic.c-ctrip.com/hotels121118/ico_favorite.png) no-repeat scroll 0 -32px rgba(0, 0, 0, 0)",width:"18px",height:"14px",display:"none",left:"-9999px",top:"-9999px"}),animateDom.appendTo(e("body"))}s=e.mod.load("animate","1.0",function(){i.animateDom.css({display:"block",left:n.left+"px",top:n.top+"px"}).animate({left:r.left+50+"px",top:r.top+5+"px"},{duration:1e3,easing:"swing",always:function(){setTimeout(function(){i.animateDom.css({display:"none",left:"-9999px",top:"-9999px"})},500)}})})}},e(".ico_fold").bind("click",function(){var t=App.floater;e(this).parentNode().addClass("sta_unfold"),t&&t.setEnd(a()),App.mapFloater&&App.mapFloater.setEnd(a())}),e(".ico_unfold").bind("click",function(){var t=App.floater;e(this).parentNode().removeClass("sta_unfold"),t&&t.setEnd(a()),App.mapFloater&&App.mapFloater.setEnd(a())}),e(".sec_item").removeClass("sta_unfold")}(cQuery,window),function(e,t){var a=e.BizMod.Serialize.objParam(e.BizMod.Serialize.serializeArray(document.forms[0]));if("object"===e.type(a)){var o=window.initFormData||{},i=[];for(var n in o)o.hasOwnProperty(n)&&i.push(n);App.formData=App.formData||e.extend(a,o),App.filterKeys=i,App.setFilterValuesToForm=function(t){var a=e(document.forms[0]);t?i.each(function(o){var i,n=t[o];if(t.hasOwnProperty(o)&&("string"==e.type(n)||"number"==e.type(n))){if(e.browser.isIE7||e.browser.isIE8){for(var r=a.find("input"),s=0;s<r.length;s++)if(r[s].name==o){i=r[s];break}}else i=a.find('input[name="'+o+'"]')[0];i||a.append(i=e.create("input",{type:"hidden",name:o,value:n})),i.value=n}}):i.each(function(e){a.find('input[name="'+e+'"]').value("")})}}}(cQuery),function(e,t,a){"use strict";function o(t){var a=document.documentElement.scrollTop||document.body.scrollTop,o=e("#searchForm").offset().top;a!==o&&e.mod.load("animate","1.0",function(){e("body").animate({scrollTop:t||o},function(){App.floater&&App.floater.reset(),App.mapFloater&&App.mapFloater.reset()}),e("html").animate({scrollTop:t||o},function(){App.floater&&App.floater.reset(),App.mapFloater&&App.mapFloater.reset()})})}function i(e,t){var a=[];return e.each(function(e){t.indexOf(e)===-1&&a.push(e)}),a}function n(a){a?t.addition=e.extend(t.addition||{},a):t.addition=a||{}}function r(t){if("object"===e.type(t)){var a=e("#searchForm"),o=e("#J_filter"),n=o.find("#J_clearAll"),r=o.find(".clear_all");for(var s in t){var l=t[s],d="string"===e.type(App.formData[s])&&""!==App.formData[s]?App.formData[s].split(","):[],c="string"===e.type(l)&&""!==l?l.split(","):[],p=i(d,c);p.each(function(e){var t=s+"-"+e,o=a.find("[id="+t+"]"),i=o.find('input[type="checkbox"]');o.removeClass("select"),i.each(function(e){e&&(e.get(0).checked=!1)}),n.find("[data-targetel="+t+"]").remove()});var u=i(c,d);u.each(function(t){var o=s+"-"+t,i=a.find("[id="+o+"]"),r=i.text(),l=i.find('input[type="checkbox"]');if("price"===s){var d=t.split("v").filter(function(e){return""!==e});1==d.length?r=parseInt(d[0],10)+"元起":2==d.length&&(r=0==d[0]?"最高"+parseInt(d[1],10)+"元":d[0]+"元至"+d[1]+"元")}if("zone"==s&&(r=e(i).find(".txt").text(),App.addition)){var c=App.addition.zoneList;if("array"!==e.type(c))return;for(var p=0,u=c.length;p<u;p++)if(c[p].id===parseInt(t)){r=c[p].name;break}}if("l"==s&&(r=i.attr("title")),"order"!==s&&"ordertype"!==s&&"a"!==s&&"page"!==s&&"couponList"!=s){i.addClass("select"),l.each(function(e){e&&(e.get(0).checked=!0)});var h=document.createElement("a");h.setAttribute("data-targetel",o),h.setAttribute("data-dopost","T"),h.setAttribute("href","javascript:;"),h.setAttribute("title","删除此条件"),h.className="J_filters-"+s,h.innerHTML=r+"<span></span>","type"==s&&e(".J_filters-group")[0]?e(h).insertBefore(e(".J_filters-group")):n.append(e(h))}})}var h;h=e(".J_brandTab.current")[0],h&&h.click(),h=e(".J_moreLandMarks.current")[0],h&&h.click(),0===n.find("a").length?(r.hide(),o.removeClass("mt_35")):(r.show(),o.addClass("mt_35"))}}function s(t){if(App.formData!==a&&"object"===e.type(t)){for(var o in t){for(var i in App.formData)i.toLowerCase()===o&&delete App.formData[i];null!=t.a&&(2&t.a?(App.formData.isusergiftcard="T",h.find("input[name=isusergiftcard]").value("T")):(App.formData.isusergiftcard="F",h.find("input[name=isusergiftcard]").value("F"))),App.formData[o]=t[o]}var n=!0;mapMessageConfig.isK1Landmark?n=!1:["zone","sl","l","s","location","district"].each(function(e){App.formData[e]&&(n=!1)}),n&&4==App.formData.orderby&&(App.formData.orderby=0,App.formData.ordertype=0)}}function l(){e("#searchForm").find(".filter_item").each(function(t){var o=t.get(0),i=o.dataset?o.dataset.type:o.getAttribute("data-type"),n="string"===e.type(i)?i.split("|"):[],r=t.find(".filter_item_unlimited"),s=null;n.each(function(e){s=App.formData[e]!==a&&""!==App.formData[e]||s===!0}),s?r.removeClass("select"):r.addClass("select")})}function d(){App.listDataFetcher||(App.listDataFetcher=new c);var e=200;p!==a&&clearTimeout(p),App.listDataFetcher._showLoading(),p=setTimeout(function(){App.listDataFetcher.fetch()},e)}function c(){this.init()}var p,u=e("#page_id"),h=e("#aspnetForm");c.prototype={constructor:c,init:function(){this.main=e(".base_main3"),this.el=e("#hotel_list"),this.account=e(".total_htl_amount"),this.sortHeader=e("#J_sortBox"),this.pagination=e(".page_box"),this.attachDistance=e("#J_AttachDistance"),this.roomTenseScore=e("#J_room_tense"),this._setupNotice()},fetch:function(){this._ajaxRequest()},_showLoading:function(){this.loading=null==this.loading?e(e.create("div",{innerHTML:"请稍等，携程正在为您实时查询。",className:"searchresult_list_load"})):this.loading,this.attachDistance.html(""),this.roomTenseScore.html(""),this.el.html(""),this.notice&&this.notice.html(""),this.el[0].parentNode.insertBefore(this.loading[0],this.el[0]),this.loading.show(),this.pagination.hide()},_setupNotice:function(){var t=e("#J_noticeHtml");t.length?this.notice=t:(this.notice=e(e.create("div",{id:"J_noticeHtml",innerHTML:""})),this.el[0].parentNode.insertBefore(this.notice[0],this.el[0])),this.noticeEvtSetted||(this.noticeEvtSetted=this._bindEvent(this.notice))},_setPageId:function(e){u.value(e?"102002":"102032")},_setNotice:function(t){"string"===e.type(t)&&this.notice&&this.notice.html(t)},_updatePageViewCount:function(t){var a=e.extend({starid:t.star},t),o=function(){window.__bfi.push(["_tracklog","hotel.list",e.stringifyJSON(a)])};window.__bfi.push(["_asynRefresh",{page_id:u.value(),url:location.href},o])},_bindEvent:function(t){return t.bind("click",function(t){var t=t||window.event,a=t.target||t.srcElement;if(t.preventDefault?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1,/J_noresultRef/.test(a.className)){var o=Array.prototype.slice.apply(e("#J_clearAll").find("a")).map(function(t){return e(t).attr("data-targetel").split("-")[0]}).unique(),i=e.parseJSON(e(a).attr("data-params"))||{},n={};o.each(function(e){e in i?n[e]=i[e].join(","):n[e]=""}),App.formData.k1="",App.formData.k2="",App.formData.OrderBy="0",App.formData.OrderType="0",App.formData.a=0,App.formData.attachDistance="0",App.update(n)}}),!0},_changeFilterHtml:function(t){if("object"===e.type(t))for(var a in t)e("#J_"+a).html(t[a])},_setHiddenvalues:function(t){"array"===e.type(t)&&t.each(function(t){var a=t.id,o=t.name,i=t.value;a?e("#"+a).value(i):o&&(App.formData[o]=i)})},_tuanRecommend:function(e){e&&RecommandTunHotel&&RecommandTunHotel(e.mandatory,e.url)},_ajaxRequest:function(){var t=[];return function(){if(App.formData!==a){var o=this;delete App.formData.__VIEWSTATE;var i=t.slice();t=[];for(var n=0;n<i.length;n++)i[n]&&i[n].abort&&i[n].abort();App.formData.RoomGuestCount=e("#J_RoomGuestCount").value();var r=(new Date).getTime();e("#J_hyatt_ad").hasClass("hidden")||e("#J_hyatt_ad").addClass("hidden");var s=e.ajax("/Domestic/Tool/AjaxHotelList.aspx",{method:"POST",context:e.extend(App.formData,{contyped:parseInt(window.getuseridentityresult()),productcode:expand(e.cookie.get("productcode"))}),onsuccess:function(a){t=[],o.loading.hide(),e("#mapContent").html(""),e.myFn.refresh(a.responseText,"post",App.formData);var i=e.parseJSON(a.responseText),n=i.hotelList,s=App.formData;if("object"===e.type(i)){if(o.el.html(n),e('script[type="text/x-cquery-template-data"]').each(function(t){var a=e(t).attr("container-id"),o=e.parseJSON(e(t).html()),i=document.createElement("div");i=e(i),window.Domestic.Group.renderGHIRoomHotelList(o,i,e("#"+a))}),o.el.find(".htl_promotion").each(function(t){e(t).regMod("jmp","1.0")}),i.sortHeader&&o.sortHeader.html(i.sortHeader),i.attachDistance&&o.attachDistance.html(i.attachDistance),o.account.html(i.totalMsg),o.pagination.html(i.paging).show(),o._setNotice(i.notice),o._setPageId(!!i.hotelAmount),o._updatePageViewCount(s),o._changeFilterHtml(i.filterHtml),o._setHiddenvalues(i.hiddenvalues),o.roomTenseScore.html(i.roomTense),e("#J_room_tense").bind("click",function(){e("#J_room_tense").css("display","none")}),App.collectHotels&&App.collectHotels.reset(),App.enablePriceCompareEntries&&App.enablePriceCompareEntries(),App.showCoupon&&App.showCoupon(!0),App.showGroupProduct&&App.showGroupProduct(),App.BindExpandSubRoom&&App.BindExpandSubRoom(),App.isCptResearch){var l=addressUrlConfig.ajaxGetCptList;l=l.slice(0,l.lastIndexOf("&star="))+"&star="+App.formData.star,App.CPT.init(l)}new App.PopMap,window.HotelMapStreetJson=i.hotelMapStreetJSON,BizData.hotelPositionJSON=i.hotelPositionJSON,mapMessageConfig.landmarks=i.landmarks,App.fetchCallback&&App.fetchCallback(),o._tuanRecommend(i.tuan),HotelRoom&&HotelRoom.reset(),App.floater&&App.floater.reset(),App.mapFloater&&App.mapFloater.reset();var d=e("#htl_search_result_hotellist"),c=i.biRecord.htl_search_result_hotellist;d.value(c),window.__bfi.push(["_tracklog",d.attr("data-key"),c]),e(".commentGrabOff").length&&commentGrabOff.construct(e(".commentGrabOff")),e("#showTipFlg").value(o.el.find("#retShowTipFlg")&&o.el.find("#retShowTipFlg").value());var p=i.HotelMaiDianData;if(p.value.loadtime=(new Date).getTime()-r,p.value.regionid=HotelMaiDianOtherData.regionid,p.value.regiontype=HotelMaiDianOtherData.regiontype,p.value.oid=HotelMaiDianOtherData.oid||"",window.__bfi.push(["_tracklog",p.key,e.stringifyJSON(p.value)]),e("#traceAdContextId").value(i.HotelListOtherData?i.HotelListOtherData.traceAdContextId:""),i.HotelExpandList&&i.HotelExpandList.length&&HotelMaiDianOtherData.oid){var u={};u.hotellist=i.HotelExpandList,u.oid=HotelMaiDianOtherData.oid,window.__bfi.push(["_tracklog","o_hotel_inland_htlexpand_online",e.stringifyJSON(u)])}i.IsShowHyattAd?e("#J_hyatt_ad").remove("hidden"):e("#J_hyatt_ad").hasClass("hidden")||e("#J_hyatt_ad").addClass("hidden")}},onerror:function(e){t=[],0!==e.status&&o.loading.hide()}});t.push(s)}}}()},t.update=function(e){r(e),s(e),l(),d(),o()},t.updateAddition=function(e){n(e)},t.getCheckedValue=function(t){return App.formData&&"string"===e.type(t)?App.formData[t]:""},t.listDataFetcher=new c}(cQuery,App),function(e,t){"use strict";function a(){o.calendar(),e(".room_alert_btn").bind("click",function(){o.reset(!0),e(".base_jmp").addClass("hidden"),o.blackBoxDisplay(),o.postAjax(o.proUrl.ajaxNoRoomRegUrl,{type:1},function(e){e&&(o.els.$mobile.value(e.phone),o.els.$email.value(e.email))})}),o.els.$hotelFormSub.bind("click",function(){var t=!1;if(o.reset(!1),e(".base_jmp").removeClass("hidden"),t=o.valPlugIn(e("#J_starttime").value(),e("#J_starttime"),"请选择入住日期","blur"),t&&(t=o.valPlugIn(e("#J_deptime").value(),e("#J_deptime"),"请选择离店日期","blur")),t&&(t=o.valPlugIn(e("#J_starttime").value().toDate(),e("#J_starttime"),"日期格式为yyyy-mm-dd","blur")),t&&(t=o.valPlugIn(e("#J_deptime").value().toDate(),e("#J_deptime"),"日期格式为yyyy-mm-dd","blur")),t&&(t=o.emptyVerfity()),t&&(t=o.deptimeVer()),o.els.$mobile.value()&&t&&(t=o.mobileVer(o.els.$mobile,o.MSG.mobileFormat)),o.els.$email.value()&&t&&(t=o.emailVer(o.els.$email,o.MSG.emailFormat)),t){var a=o.submitHandler(o.els.$hotelForm.find(".input_txt"));a.type=2,a.cityId=e("#cityId").value(),a.cityName=e("#cityName").value(),o.postAjax(o.proUrl.ajaxNoRoomRegUrl,a,o.formVerFun)}}),o.els.$hotelForm.bind("keydown",function(e){13==e.keyCode&&(e.stop(),o.els.$hotelFormSub.trigger("click"))}),o.els.$hotelForm.find(".input_txt").bind("focus",function(){o.tipsHidden(e(this)),e("#J_tips").addClass("hidden")}),o.els.$closeHotelFloatBtn.bind("click",function(){o.blackBoxDisappear(),e(".base_jmp").addClass("hidden")})}var o={els:{$starttime:e("#J_starttime"),$deptime:e("#J_deptime"),$mobile:e("#J_mobile"),$email:e("#J_email"),$mask:e("#J_mask"),$specTips:e("#J_tips"),$hotelForm:e("#J_hotelFloatFormBox"),$hotelFormSmall:e("#J_hotelFloatFormSmallBox"),$hotelFormSub:e("#J_hotelFloatFormSub"),$alertSuc:e("#J_alertSuc"),$alertFail:e("#J_alertFail"),$closeHotelFloatBtn:e(".close")},proUrl:{ajaxNoRoomRegUrl:"/Domestic/Tool/AjaxNoRoomRegister.aspx"},ins_2:e(document).regMod("validate","1.1"),calendar:function(){e.mod.load("calendar","6.0",function(){o.els.$starttime.regMod("calendar","6.0",{options:{showWeek:!0,nextEl:"#J_deptime"}});var t=(o.els.$starttime,o.els.$deptime);t.regMod("calendar","6.0",{options:{showWeek:!0,reference:"#J_deptime"}}),o.els.$starttime.bind("change",function(a){if(o.els.$starttime.value().toDate()&&e("#J_deptime").value().toDate()){o.els.$deptime.unregMod("calendar","6.0");var i=o.els.$starttime.value().toDate(),n=i.addDays(1),r=o.els.$deptime.value().toDate();i>r&&o.els.$deptime.value(i.addDays(1).toFormatString("yyyy-MM-dd")),t.data("minDate",n.toStdDateString())}})}),e("#J_starttime,#J_deptime").bind("change",function(){if(o.els.$starttime.value().toDate()&&e("#J_deptime").value().toDate()){var t=o.els.$starttime.value().toDate(),a=e("#J_deptime").value().toDate();t.addDays(28)<a&&o.ins_2.method("show",{$obj:e("#J_deptime"),data:"您入住酒店时间超过28天，请分开订阅有房提醒",removeErrorClass:!0,hideEvent:"blur",isScroll:!1})}})},MSG:{mobileFormat:"请填写正确的手机号码,手机号码为13、14、15、17或18开头且长度为11位。",emailFormat:"请填写正确的E-mail,格式为a@b.c。",deptimeFormat1:"请选择2天后日期。",deptimeFormat2:"请选择120天内日期。",deptimeFormat3:"您入住酒店时间超过28天，请分开订阅有房提醒。"},Regex:{legalVer:"[\\*,\\&,\\\\,\\/,\\?,\\|,\\:,\\<,\\>,',\"]",moblieVer:/^1[3|4|5|7|8]\d{9}$/,emailVer:/^([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/},tipsTemp:function(t){return e(t.parentNode().find(".error_tips")[0])},tipsHidden:function(e){e.removeClass("error");var t=o.tipsTemp(e);t.addClass("hidden")},tipsShow:function(e,t){e.addClass("error");var a=o.tipsTemp(e);a.removeClass("hidden").find("span").html(t)},displayShift:function(e,t){e.addClass("hidden"),t.removeClass("hidden")},floatHidden:function(e){e.unmask()},floatShow:function(e){e.mask()},emptyVerfity:function(t){var a;return o.els.$mobile.value()||e("#J_email").value()?(o.els.$mobile.removeClass("error"),o.els.$specTips.addClass("hidden"),a=!0):(o.els.$mobile.addClass("error"),o.els.$specTips.removeClass("hidden"),a=!1),a},mobileVer:function(e,t){var a,i=e.value(),n=o.Regex.moblieVer;return n.test(i)?(o.tipsHidden(e),a=!0):(o.tipsShow(e,t),a=!1),a},emailVer:function(e,t){var a,i=e.value(),n=o.Regex.emailVer;return n.test(i)?(o.tipsHidden(e),a=!0):(o.tipsShow(e,t),a=!1),a},deptimeVer:function(){var e=!1,t=new Date,a=o.els.$starttime.value().toDate(),i=o.els.$deptime.value().toDate();return a&&i&&(a<t.addDays(1)?(o.tipsShow(o.els.$starttime,o.MSG.deptimeFormat1),e=!1):t.addDays(120)<a?(o.tipsShow(o.els.$starttime,o.MSG.deptimeFormat2),e=!1):a.addDays(28)<i?(o.tipsShow(o.els.$starttime,o.MSG.deptimeFormat3),e=!1):(o.tipsHidden(o.els.$starttime),e=!0)),e},submitHandler:function(e){var t={};return e.each(function(e){var a=e.attr("name");t[a]=e.value()}),t},postAjax:function(t,a,i){cQuery.ajax(t,{method:"POST",context:a,onsuccess:function(t){var t=e.parseJSON(t.responseText);i&&"function"==typeof i&&i(t)},onerror:function(){o.displayShift(o.els.$hotelFormSmall,e("#J_alertFail"))}})},formVerFun:function(t){if(200==t.Code)if("false"===t.Data.Success){var a=t.Data.Info;a.Key?o.els.$hotelForm.find(".input_txt").each(function(e){e.attr("name").toLowerCase()==a.Key.toLowerCase()&&o.tipsShow(e,a.Value)}):o.tipsShow(o.els.$email,a.Value)}else o.displayShift(o.els.$hotelFormSmall,e("#J_alertSuc"));else o.displayShift(o.els.$hotelFormSmall,e("#J_alertFail"))},reset:function(t){o.els.$hotelForm.find(".input_txt").removeClass("error").removeClass("f_error"),o.els.$alertSuc.addClass("hidden"),o.els.$alertFail.addClass("hidden"),t&&(e(".error_tips").addClass("hidden"),o.els.$starttime.value(e("#checkIn").value()),o.els.$deptime.value(e("#checkOut").value()))},blackBoxDisplay:function(){o.els.$hotelFormSmall.removeClass("hidden"),o.els.$hotelForm.removeClass("hidden").mask().css({background:"white"})},blackBoxDisappear:function(){o.els.$hotelForm.addClass("hidden").unmask(),o.els.$hotelFormSmall.addClass("hidden")},valPlugIn:function(e,t,a,i){var n;return e?n=!0:(o.ins_2.method("show",{$obj:t,data:a,removeErrorClass:!0,hideEvent:i,isScroll:!1}),n=!1),n}};App.hotelPopBindEvents=a}(cQuery),function(e,t){function a(t){if(hotelDomesticConfig.hasLogin&&App.couponData)return e("#J_ShowCoupon").html("可用优惠券<div id='J_CouponList' class='available_coupon_pop hidden'>"+App.couponData+"</div>"),e("#J_ShowCoupon input").each(function(e){e[0].checked=!1}),e("#J_ShowCoupon").removeClass("hidden"),o(),t&&n(),void r();var a="/Domestic/Tool/AjaxGetCouponData.aspx?from=list";e.ajax(a,{cache:!1,onsuccess:function(a){var a=a.responseText;a&&(e("#J_ShowCoupon").html(a),e("#J_ShowCoupon").removeClass("hidden"),o(),t&&n(),r())},onerror:function(){}})}function o(){var t=e("#defaultcoupon").value(),a=t&&t.split(",")||[];a.length>0&&e("#J_CouponList input").each(function(e){for(var t=0;t<a.length;t++)if(e.attr("data-id")==a[t]){e[0].checked=!0;break}}),i(a.length)}function i(t){var a="可用优惠券",o=e("#J_ShowCoupon").firstChild();t>0&&(a=a+"("+t+")"),o.text(a)}function n(){e("#J_ShowCoupon").bind("mouseover",function(t){t=t||window.event,t.preventDefault?t.stopPropagation():t.cancelBubble=!0,e("#J_ShowCoupon").addClass("coupon_open"),e("#J_CouponList").removeClass("hidden");var a="htl_coupon",o="{cityid:'"+e("#cityId").value()+"',hotelid:'',ison:'"+(hotelDomesticConfig.hasLogin?1:0)+"'}";window.__bfi.push(["_tracklog",a,o])}),e("#J_ShowCoupon").bind("mouseout",function(t){t=t||window.event,t.preventDefault?t.stopPropagation():t.cancelBubble=!0,e("#J_ShowCoupon").removeClass("coupon_open"),e("#J_CouponList").addClass("hidden")})}function r(){e("#J_ShowCoupon").bind("click",function(t){t=t||window.event,t.preventDefault?t.stopPropagation():t.cancelBubble=!0;var a=t.target;if("INPUT"==a.tagName||"SPAN"==a.tagName){var o="",n="",r=0;e("#J_CouponList input").each(function(e){e[0].checked&&(o+=","+e.attr("data-id"),n+=","+e.attr("data-amount"),r++)}),i(r),App.couponData=e("#J_CouponList").html(),App.Isfilter=!0,o.length>0&&(o=o.substr(1,o.length-1),n=n.substr(1,n.length-1)),e("#defaultcoupon").value(o);var s="htl_coupon_num",l="{cityid:'"+e("#cityId").value()+"',hotelid:'',price:'"+n+"'}";window.__bfi.push(["_tracklog",s,l]);var d={};d.couponList=o,d.page=1,App.update(d)}}),e("#J_LoginForCoupon").bind("click",function(e){hotelDomesticConfig.hasLogin||__SSO_booking_1(this.id,0)})}a(!0),App.showCoupon=a}(cQuery),function(e,t){t.rtMoneyBobble={init:function(){var t=this;e.storage.get("rt_hotel_result")||(e(".J_rtPriceTips").css("display",""),e(".J_rtPriceTips .J_close").bind("click",function(){e(".J_rtPriceTips").css("display","none"),t.hide()}))},hide:function(){e.storage.set("rt_hotel_result","T")}},rtMoneyBobble.init()}(cQuery,window),function(e,t){t.trackLog={checkin:e("#checkIn").value()||"",checkout:e("#checkOut").value()||"",keyword:e("#hotelAreaName").value()||"",init:function(t){ISFROMINDEX&&window.__bfi.push(["_tracklog","htl_home_search_situation",e.stringifyJSON({pageid:e("#page_id").value()||"",from:e("#txtCity").value()||"",checkindate:this.checkin||"",checkoutdate:this.checkout||"",searchkey:this.keyword||"",others:"",cityId:HotelMaiDianOtherData.cityid,regionid:HotelMaiDianOtherData.regionid,regiontype:HotelMaiDianOtherData.regiontype})])}},trackLog.init()}(cQuery,window),function(e,t){function a(){var t="/Domestic/Tool/AjaxGetGroupProductList.aspx",a="";e(".searchresult_name").each(function(e){a+=e.attr("data-id")+","});var o={city:e("#cityId").value(),hotels:a,checkin:e("#checkIn").value(),checkout:e("#checkOut").value()
};e.ajax(t,{method:"POST",context:o,cache:!1,onsuccess:function(t){var t=e.parseJSON(t.responseText);if(t)for(var a=0;a<t.length;a++)e("#group"+t[a].id).html(t[a].txt)},onerror:function(){}})}a(),App.showGroupProduct=a}(cQuery),function(e){var t=function(){e(".J_ViewRoom").bind("click",function(){var t=e(this),a=t.attr("param"),o=addressUrlConfig.ajaxViewRooms,i=t.attr("hotel"),n="展开房型",r="收起房型",s=e("#rl_"+i).html();t.hasClass("show_unfold")?s?(e("#rl_"+i).removeClass("hidden"),t.removeClass("show_unfold"),t.addClass("show_fold"),t.html(r)):(t.removeClass("show_unfold"),t.addClass("show_fold"),t.html(r),e("#rl_"+i).html('<div class="room_list_load"><i></i>正在加载，请稍候.....</div>'),e.ajax(o+"?hotel="+i,{method:"POST",context:a,cache:!1,onsuccess:function(t){var a=t.responseText;if(a){e("#rl_"+i).html(a);var o=e(".J_Price_"+i),n=e(".J_NewRMBPrice_"+i);o&&n&&n.html()&&o.html(n.html());var r=e(".J_OriPrice_"+i),s=e(".J_NewOriPrice_"+i);r&&s&&s.html()&&r.html(s.html())}},onerror:function(){}})):(e("#rl_"+i).addClass("hidden"),t.addClass("show_unfold"),t.removeClass("show_fold"),t.html(n))})};t(),App.BindExpandSubRoom=t}(cQuery),function(e,t){function a(){var t="";if(e.cookie.get("OID_ForOnlineHotel"))t=e.cookie.get("OID_ForOnlineHotel");else{var a=(e.cookie.get("_bfa")||"").split(".");a&&a.length>=3&&(t=a[1]+a[2]+(new Date).getTime()+e("#page_id").value(),e.cookie.set("OID_ForOnlineHotel","",t,{path:"/"}))}if(HotelMaiDianOtherData.oid=t,HotelMaiDianOtherData.hotelExpandList&&t){var o={};o.hotellist=HotelMaiDianOtherData.hotelExpandList,o.oid=t,o.oid&&window.__bfi.push(["_tracklog","o_hotel_inland_htlexpand_online",e.stringifyJSON(o)])}}window.__rmsbfi=window.__rmsbfi||[],window.__rmsbfi.push(["_getRmsToken",function(e){window.rmsTokenSearch=e}]),a(),App.setHotelPyramidTrace=function(t,a){if(t&&e("#hasPyramid").value()){var o=e("#"+t);if(0!=o.length){var i=parseInt(o.attr("data-index"))||0,n=25*((parseInt(o.attr("data-page"))||0)-1),r=parseInt(o.attr("data-adposition"))||0;e("#hotelposition").value(i+n+","+r);var s="/Domestic/Tool/AjaxHotelPyramidTrace.aspx",l={hotelId:t,city:App.formData.cityId||"",zone:App.formData.zone||"",keyword:App.formData.keyword||"",star:App.formData.star||"",adposition:r,sequence:i+n,action:"fav"==a?6:4,pageId:e("#page_id").value(),traceAdContextId:e("#traceAdContextId").value(),rmstoken:window.rmsTokenSearch};e.ajax(s,{method:"POST",context:l,cache:!1,onsuccess:function(){},onerror:function(){}})}}}}(cQuery);var tracklog=function(){function e(e,t){"undefined"==typeof window.__bfi&&(window.__bfi=[]),window.__bfi.push(["_tracklog",e,t])}function t(e,t){var a=t?t.document.createElement("div"):document.createElement("div"),o=document.createDocumentFragment();a.innerHTML=e;var i=a.children;if(i.length>1){for(;i.length>0;)o.appendChild(i[0]);return o}return i[0]}function a(){$(t('<input type="hidden" id="hod_detail_picture" />')).appendTo($("body"))}var o,i,n,r,s,l,d,c,p=$("#cityId").value();return a(),{hotDetailPictureTrack:function(t){p=p||"",i=t.attr("data-hotelid")||"",n=t.attr("data-pictureid")||"",r=t.attr("data-cli_type")||"",s=t.attr("data-source")||"酒店官方",d=t.attr("data-pic_rank")||"1",c=t.attr("data-pic_num")||"";var a=t.attr("data-pic_type");a="1,13"==a?"外观":"2,3,4,5,11"==a?"内景":"6,14"==a?"房间":"所有",l=a||"所有",o="{cityid:'"+p+"',hotelid:'"+i+"',pictureid:'"+n+"',cli_type:'"+r+"',source:'"+s+"',pic_type:'"+l+"',pic_rank:'"+d+"',pic_num:'"+c+"',}",$("#hod_detail_picture").value(o),e("hod_detail_picture",o)},threeSixZoreTrack:function(t){p=p||"",i=t.attr("data-hotelid")||"",n="",r="4",s="360",d="",c="",l=t.attr("data-picType"),o="{cityid:'"+p+"',hotelid:'"+i+"',pictureid:'"+n+"',cli_type:'"+r+"',source:'"+s+"',pic_type:'"+l+"',pic_rank:'"+d+"',pic_num:'"+c+"',}",e("hod_detail_picture",o)}}}();
!function(e){function o(){"undefined"!=typeof useNewCompare&&useNewCompare||i.check()}function n(e,o){i.makeOrder(e,o)}function t(e){i.callSuccessAuthStatus(e)}var i={container:{},hotelId:0,config:{FAIL_DOM:$(".compare_fail_pop"),POPUI_DOM:$(".compare_pop"),TITLEBAR:$(".compare_pop_hd"),HOTEL_LIST_DOM:$("#hotel_list,#hotelRoomBox"),HOTEL_LIST_DOM_ID:"#hotel_list,#hotelRoomBox",LOADING_HTML:$(".compare_pop_loading").parentNode().html(),ORIGINAL_PAGE_ID:$("#page_id").value(),ORIGINAL_URL:window.location.toString(),POPUI_PAGE_ID:"102002"==$("#page_id").value()?"599003991":"599003992",POPUI_URL_TMPL:window.location.origin+"/pricecmp/hotelid{$0}.html",POP_POSITION:{top:0,left:0,scrollTop:0,width:0,height:0,popBodyHeight:0},ROOT_CONTAINER:$.browser.isIE||$.browser.isIE11?document.documentElement:document.body,ISMAXED:!1},init:function(){var e=this;e.config.FAIL_DOM.find(".close").bind("click",function(o){e.container.unmask(),e.config.ROOT_CONTAINER.scrollTop=e.config.POP_POSITION.scrollTop,e.config.ROOT_CONTAINER.style.overflow="auto"}),e.config.POPUI_DOM.find(".close").bind("click",function(o){o.stopPropagation?o.stopPropagation():o.cancelBubble=!0,e.container.unmask(),e.config.ROOT_CONTAINER.scrollTop=e.config.POP_POSITION.scrollTop,e.config.ROOT_CONTAINER.style.overflow="auto",e.hotelId&&(e._sendUBT(),e.hotelId=0),i.config.ISMAXED=!1}),e._getHotelList().bind("click",function(o){var n=$(o.target);if(n.hasClass("J_priceCmpEntry")){var t=n.attr("data-hotelid"),i=n.attr("data-hotelname");t&&i&&e._load(t,i)}})},check:function(){var e=$(".J_priceCmpEntry"),o=[];e.each(function(e){o.push(e.attr("data-hotelid"))})},makeOrder:function(e,o){var n="T"===$(e).attr("data-checkAuth"),t="T"===$("#J_hasLogin4ComparePrice").value();n&&!t&&((o=o||window.event)&&(o.returnValue=!1,o.preventDefault&&o.preventDefault()),window.__SSO_booking(e.id,1))},callSuccessAuthStatus:function(e){var o=$("#"+e);o.length>0&&o.trigger("click"),$("#J_hasLogin4ComparePrice").value("T")},_load:function(e,o){var n=this,t=n._getFormOptions();n._updateCurrentHotelId(e),n._showLoadingPanel(o);var i=$(".J_priceInfo a").filter(".selected").attr("data-value");$.BizMod.Promise(this._getElevenValue).any(function(o){n._pollCas({hotelId:e,checkIn:t.checkIn,checkOut:t.checkOut,returnCash:i,edm:t.EDM,eleven:encodeURIComponent(o)})})},_bindBaseRoomEvents:function(){var e=this,o=e.container;o.find(".J_foldBar").bind("click",function(o){var n=$(this),t=o.target,i=n.attr("data-index"),a=n.offset().height,r=["btn_compare","room_btn","btn_fold","btn_unfold","room_type_name"];t&&r.indexOf(t.className)!==-1&&(o.stop(),n.hasClass("modular_fold")?e._unfold(n):n.hasClass("modular_unfold")&&(e._fold(n),$(".compare_pop_bd")[0].scrollTop=i*a))}),o.find("div.room_type>.room_type_name, .room_btn>span").bind("click",function(o){var n=$(this),t=e._getCurrentBaseRoom(n),i=t.attr("data-tracekey"),a=t.attr("data-tracevalue");e._sendTrack(i,a)}),o.find(".J_makeOrder").bind("click",function(){var o=$(this),n=o.attr("data-tracekey"),t=o.attr("data-tracevalue");$(".J_priceInfo a").filter(".selected").attr("data-value"),e._getFormOptions();e._sendTrack(n,t)}),o.find("a.more_unfold").bind("click",function(o){var n=e._getCurrentBaseRoom($(this));n.find(".room_caplist").removeClass("hidden"),n.find(".room_type_info").addClass("hidden"),n.find(".J_ViewRoomDetail").addClass("hidden")}),o.find("li.more_fold a").bind("click",function(o){var n=e._getCurrentBaseRoom($(this));n.find(".room_caplist").addClass("hidden"),n.find(".room_type_info").removeClass("hidden"),n.find(".J_ViewRoomDetail").removeClass("hidden")}),o.find("a.more_price").bind("click",function(){var o=$(this),n=e._getCurrentSubRoom(o);o.addClass("hidden"),n.find(".child_room_model").addClass("child_room_open").removeClass("hidden"),n.find(".supplier_logo").addClass("supplier_logo_open")}),o.find(".more_supplier_btn a").bind("click",function(){var o=$(this),n=e._getCurrentBaseRoom(o);o.addClass("hidden"),n.find(".child_room").removeClass("hidden")}),o.find(".compare_pop_hd")[0].ondblclick=function(){e._maxiumAndMinium()},e.config.TITLEBAR.bind("mousedown",a.start),e._bindEventForHoverOnRoomPic()},_maxiumAndMinium:function(){var e=this.container,o=this;if(parseInt(e.css("width"))===document.documentElement.clientWidth)o.config.ROOT_CONTAINER.scrollTop=o.config.POP_POSITION.scrollTop,e.css({width:o.config.POP_POSITION.width+"px",top:o.config.POP_POSITION.top+"px",left:o.config.POP_POSITION.left+"px",height:o.config.POP_POSITION.height+"px"}),o.config.POP_POSITION.popBodyHeight&&e.find(".compare_pop_bd").css({height:o.config.POP_POSITION.popBodyHeight+"px"}),o.config.ISMAXED=!1;else{o.config.POP_POSITION.scrollTop=o.config.ROOT_CONTAINER.scrollTop,o.config.ROOT_CONTAINER.scrollTop=0,o.config.ROOT_CONTAINER.style.overflow="hidden",o.config.POP_POSITION.top=e.offset().top,o.config.POP_POSITION.left=e.offset().left,o.config.POP_POSITION.width=e.offset().width,o.config.POP_POSITION.height=e.offset().height;var n=e.find(".compare_pop_bd");o.config.POP_POSITION.popBodyHeight=n.offset().height-10,n.css({height:document.documentElement.clientHeight-50+"px"}),e.css({width:document.documentElement.clientWidth+"px",top:0,left:0,height:document.documentElement.clientHeight+"px"}),o.config.ISMAXED=!0}},_getCurrentBaseRoom:function(e){return this._has(this.container.find(".J_foldBar"),e)},_getCurrentSubRoom:function(e){return this._has(this.container.find(".J_foldBar .child_room"),e)},_has:function(e,o){var n=void 0;return e.each(function(e,t){if(e.contains(o))return n=e,!1}),n},_unfold:function(e){var o=this,n=e||o.container.find(".modular_fold"),t=n.attr("data-index"),i=o.container.find(".J_foldList");n.removeClass("modular_fold").addClass("modular_unfold"),n.find(".J_modular_warp").addClass("modular_unfold_wrap"),n.find(".btn_unfold").removeClass("hidden"),n.find(".btn_fold").addClass("hidden"),n.find(".modular_list, .room_pic, .room_caplist, .more_unfold").addClass("hidden"),n.find(".room_caplist").addClass("hidden"),i.filter("[data-index="+t+"]").addClass("hidden"),n.find(".btn_fast").addClass("hidden"),n.find(".btn_compare").removeClass("hidden"),n.find(".room_type_info").removeClass("hidden")},_fold:function(e){var o=this;e.attr("data-index"),o.container.find(".J_foldBar"),o.container.find(".J_foldList");o._unfold(),e.removeClass("modular_unfold").addClass("modular_fold"),e.find(".J_modular_warp").removeClass("modular_unfold_wrap"),e.find(".modular_list, .room_pic, .more_unfold").removeClass("hidden"),e.find(".btn_unfold").addClass("hidden"),e.find(".btn_fold").removeClass("hidden"),e.find(".room_type_info").removeClass("hidden"),e.find(".room_caplist").addClass("hidden")},_foldFirstBaseRoom:function(){var e=this.container.find(".J_foldBar:first");this._fold(e)},_sendUBT:function(){var e=this;window.__bfi.push(["_asynRefresh",{page_id:e.config.POPUI_PAGE_ID,url:e.config.POPUI_URL_TMPL.replace("{$0}",e.hotelId),refer:e.config.ORIGINAL_URL}])},_sendTrackLog:function(){var e=$("#J_compareBtnTraceKey").value()||"htl.searchbtn.pri",o=$("#J_compareBtnTraceValue").value();e&&o&&window.__bfi.push(["_tracklog",e,o])},_sendTrack:function(e,o){e&&o&&window.__bfi.push(["_tracklog",e,o])},_updateCurrentHotelId:function(e){this.hotelId=e},_updatePanelContent:function(e){var o=this;o.container&&o.container.find(".compare_pop_bd").html(e)},_showLoadingPanel:function(e){var o=this;o.config.POP_POSITION.scrollTop=o.config.ROOT_CONTAINER.scrollTop,o.config.ROOT_CONTAINER.style.overflow="hidden",o.container=$(o.config.POPUI_DOM);var n=o.container.find(".compare_pop_bd");o.config.POP_POSITION.height&&o.container.css({height:o.config.POP_POSITION.height+"px"}),o.config.POP_POSITION.popBodyHeight&&n.css({height:o.config.POP_POSITION.popBodyHeight+"px"}),o.container.find(".J_hotelName").text(e),n.html(o.config.LOADING_HTML),o.container.mask()},_showErrorPanel:function(e){var o=this;o.container.unmask(),o.container=$(o.config.FAIL_DOM),o.container.find(".J_hotelName").text(e),o.container.mask(),setTimeout(function(){o.container.mask()},2e3)},_getHotelList:function(){return $(this.config.HOTEL_LIST_DOM_ID)},_getFormOptions:function(){return{checkIn:$("#checkIn").value(),checkOut:$("#checkOut").value(),EDM:$("#J_edm").value(),pageType:$("#pagetype").value(),useFPGP:$("#useFPGP").value()}},_bindEventForHoverOnRoomPic:function(){var e=null,o="",n=document.getElementById("popRoomPic");$(".room_pic").bind("mouseover",function(t){t=t||window.event;var i=t.target||t.srcElement;if(e&&clearTimeout(e),"IMG"==i.nodeName){var a=i.getAttribute("_src");if(!a)return;o!=a&&(n.getElementsByTagName("img")[0].src=a,o=a),e=setTimeout(function(){n.style.display="",$("#popRoomPic").css("z-index",1e3),o&&(n.style.left=parseInt($(i).offset().left)+parseInt($(i).offset().width)+3+"px",n.style.top=parseInt($(i).offset().top)+"px")},300)}}).bind("mouseout",function(e){e=e||window.event;var t=e.target||e.srcElement;"IMG"==t.nodeName&&(o="",n.style.display="none",n.style.top="-1000px",n.getElementsByTagName("img")[0].src="//pic.c-ctrip.com/common/pic_alpha.gif")})},_pollCas:function(e,o){"function"!==$.type(o)&&(o=function(){}),window.EXPRESSION&&EXPRESSION.poll("/domestic/cas/nevermore/RemoteCall",null,"POST",hotelDomesticConfig.cas.NeverMore,o,null,e)},_getElevenValue:function(e){function o(e){for(var o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n="",t=0;t<e;t++){var i=Math.ceil(25*Math.random());n+=o[i]}return n}var n,t=o(7),i=!1;if(!hotelDomesticConfig.cas.OceanBall)return e.resolve("");for(;window[t];)t=o(15);n=hotelDomesticConfig.cas.OceanBallUrl+"?callback="+t+"&_="+(new Date).getTime(),window[t]=function(o){window[t]=void 0;var n="";try{n=o()}catch(a){$.ajax("/domestic/cas/image/bi",{method:$.AJAX_METHOD_POST,cache:!1,context:{value:"11-"+encodeURIComponent(a.stack||a)}})}finally{i=!0,e.resolve(n)}},$.loader.js(n,{onload:function(){i||(window[t]=void 0,e.reject(""))},onerror:function(o){o&&(window[t]=void 0),e.reject("")}})}};"undefined"!=typeof useNewCompare&&useNewCompare||(i.init(),i.check()),e.enablePriceCompareEntries=o,e.makeOrderPriceCompare=n,e.callSuccessAuthStatus=t;var a={X:0,Y:0,element:null,start:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,i.config.ISMAXED||$(e.target).hasClass("close")||(e=e||window.event,a.element=this,this.setCapture?this.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP),a.X=e.clientX-this.parentNode.offsetLeft||0,a.Y=e.clientY-this.parentNode.offsetTop||0,document.onmousemove=a.move,document.onmouseup=a.stop)},move:function(e){e=e||window.event;var o=i.config.POPUI_DOM,n=Math.max(e.clientX-a.X,0),t=Math.max(e.clientY-a.Y,i.config.ROOT_CONTAINER.scrollTop);o.css({left:n+"px",top:t+"px",position:"absolute"})},stop:function(e){function o(e,o,n){e.removeEventListener?e.removeEventListener(o,n,!1):e.detachEvent("on"+o,n)}$.browser.isIE?(o(a.element,"losecapture",a.start),a.element.releaseCapture()):o(window,"blur",a.start),document.onmousemove=null,document.onmouseup=null}}}(window.App=window.App||{});
!function(){var t=['<div class="htl_room_table">','<table border="0" cellspacing="0" cellpadding="0" summary="详情页酒店房型列表">',"<tbody>","<tr>",'<th class="col1">房型</th>','<th class="col2"></th>','<th class="col3">床型</th>','<th class="col4">宽带</th>','<th class="col5">早餐</th>','<th class="col_policy">政策</th>','<th class="col6">','<span class="room_preis">房价（含服务费）</span>',"</th>",'<th class="col7"></th>',"</tr>","{{each data}}","<tr>",'<td class="room_type">','<a class="pic" href="${ProductUrl}">','<img src="${ImageUrl}" _src="${ImageUrl}"></a>','<a class="room_unfold" title="${ProductName}" href="${ProductUrl}">',"${ProductName}","<br></a>","</td>",'<td class="child_name">','<span class="label_onsale_red" title="团购产品，购买后请电话酒店预约入住时间">团购券</span>',"</td>",'<td class="col3">${BedType}</td>','<td class="col4">',"<span class=\"b_none\" data-role=\"jmp\" class=\"net_free\" data-params=\"{'options':{'type':'jmp_table','template':'#jmpTempNet','content':{'txt':'${NetworkInfoDescription}'},'classNames':{'boxType':'jmp_table'},'css':{'maxWidth':500},'group':'net'}}\">${NetworkInfo}</span>","</td>",'<td class="col5">',"<span>${BreakfastType}</span>","</td>",'<td class="col_policy">',"<span class=\"room_policy\" data-role=\"jmp\" data-params=\"{'options':{'type':'jmp_table','template':'#jmpTempCacnel','content':{'txt':'团购支持未消费退款、过期返还、不满意免单。'},'classNames':{'boxType':'jmp_table'},'css':{'maxWidth':500},'group':'cashback'}}\">免费取消</span>","</td>","<td>",'<span class="base_price"> <dfn>¥</dfn>',"${ShownPrice}","</span>",'{{if MarketPrice!="0"}}','<span class="base_txtdiv">','<span class="j">',"-${MarketPrice}","</span>","</span>","{{/if}}","</td>",'<td class="col7">','<a href="${ProductUrl}" target="_blank" class="btn_buy group_btn_buy J_TuanBtn" ctripid="${CtripId}" productid="${ProductId}">抢购</a>','<span class="icon_prepay" title="需预先支付房款"> </span>',"</td>","</tr>","{{/each}}","</tbody>","</table>","</div>"].join(""),a=['<table width="100%" cellspacing="0" cellpadding="0" border="0" class="hotel_datelist ">',"<thead>","<tr>",'<th style="padding-left: 23px;" class="th_room">房型</th>','<th style="width: 40px;">床型</th>','<th style="width: 40px;">早餐</th>','<th style="width: 42px;">宽带</th>','<th style="width: 50px;" class="th_policy">政策</th>','<th style="width: 90px;" class="text_right">','<div class="price_th">',"房价",'<span class="price_tips">(含服务费)</span>',"</div>","</th>",'<th style="width: 95px;"></th>','<th style="width: 70px;"></th>','<th style="width: 25px;"></th>',"</tr>","</thead>","<tbody>","{{each(i,r) data}}","{{if i<3}}","<tr>","{{else}}",'<tr data-type="hidden" style="display:none;">',"{{/if}}",'<td class="hotel_room">','<a class="hotel_roompic" href="${ProductUrl}" target="_blank">&nbsp;</a>','<a class="hotel_room_name" href="${ProductUrl}" target="_blank" title="${ProductName}">${ProductName}</a>','<span class="label_onsale_red" title="团购产品，购买后请电话酒店预约入住时间">团购券</span>',"</td>","<td>","<span>${BedType}</span>","</td>","<td>${BreakfastType}</td>","<td>","<span>${NetworkInfo}</span>","</td>","<td>","<span class=\"room_policy\" mod_jmpinfo_page=\"hotels_icon_tips\" data-role=\"jmp\" data-params=\"{'options':{'type':'jmp_table','template':'#jmpTempCacnel','content':{'txt':'团购支持未消费退款、过期返还、不满意免单。'},'classNames':{'boxType':'jmp_table'},'css':{'maxWidth':500},'group':'cashback'}}\" mod=\"jmpInfo\">免费取消</span>","</td>",'<td class="htl_price_td text_right">','<span class="base_txtdiv"> <dfn>¥</dfn>',"${ShownPrice}","</span>","</td>","<td>","</td>","<td>",'<a href="${ProductUrl}" target="_blank" class="btn_buy group_btn_buy J_TuanBtn" ctripid="${CtripId}" productid="${ProductId}">抢购</a>','<span class="icon_prepay" title="需预先支付房款"> </span>',"</td>","</tr>","{{/each}}","</tbody>","</table>","{{if data.length>3}}",'<p class="searchresult_toggle"> <a class="show_unfold float_right" onclick="" href="javascript:void(0);">展开全部房型</a></p>',"{{/if}}"].join(""),e=function(a,e){var s=$.tmpl.render(t,{data:a});e=(e||$("#hotelRoomBox")).html(s),l(e,"htl_detail_tuanrush")},s=function(t,e,s){var o=$.tmpl.render(a,{data:t});e.html(o),s&&s.append(e),e.find("a.show_unfold").bind("click",function(t){var a=e.find('tr[data-type="hidden"]');$(this).hasClass("show_unfold")?(a.removeAttr("style"),$(this).removeClass("show_unfold").addClass("show_fold").text("收起房型")):(a.hide(),$(this).addClass("show_unfold").removeClass("show_fold").text("展开全部房型"))}),l(e,"htl_list_tuanrush")};$.ready(function(){var t=$("#GHI_changeBtn");if(0!==t.length){var a='<div class="room_list_loading">给力加载中，请稍候......</div>';t.bind("click",function(){$("#hotelRoomBox").html(a),$.ajax([addressUrlConfig.AjaxGHIGroupProduct,"&startDate=",$("#cc_txtCheckIn").value(),"&endDate=",$("#cc_txtCheckOut").value(),"&_=",+new Date].join(""),{cache:!1,onsuccess:function(t){var a=t.responseText&&$.parseJSON(t.responseText);e(a)}})}),t.trigger("click"),$("#hotelRoomBox").html(a);var s=null,o="";$("#hotelRoomBox, #commentList").bind("mouseover",function(t){t=t||window.event;var a=t.target||t.srcElement;if(s&&clearTimeout(s),"IMG"==a.nodeName){var e=a.getAttribute("_src");if(!e)return;o!=e&&(popRoomPic.getElementsByTagName("img")[0].src=e,o=e),s=setTimeout(function(){popRoomPic.style.display="",o&&(popRoomPic.style.left=parseInt($(a).offset().left)+parseInt($(a).offset().width)+3+"px",popRoomPic.style.top=parseInt($(a).offset().top)+"px")},500)}}).bind("mouseout",function(t){t=t||window.event;var a=t.target||t.srcElement;"IMG"==a.nodeName&&(o="",popRoomPic.style.display="none",popRoomPic.style.top="-1000px",popRoomPic.getElementsByTagName("img")[0].src="//pic.c-ctrip.com/common/pic_alpha.gif")})}}),window.Domestic=window.Domestic||{},window.Domestic.Group=window.Domestic.Group||{};var o=function(t,a){var e=$(t).attr("ctripid"),s=$(t).attr("productid"),o=$("#cc_txtCheckIn").value()||$("#txtCheckIn").value(),l=$("#cc_txtCheckOut").value()||$("#txtCheckOut").value();window.__bfi.push(["_tracklog",a,$.stringifyJSON({hotelid:e,productid:s,checkin:o,checkout:l})])},l=function(t,a){t.find(".btn_buy").bind("click",function(){o($(this),a)})};$.extend(window.Domestic.Group,{renderGHIRooms:e,renderGHIRoomHotelList:s}),$.ready(function(){$('script[type="text/x-cquery-template-data"]').each(function(t){var a=$(t).attr("container-id"),e=$.parseJSON($(t).html()),s=document.createElement("div");s=$(s),window.Domestic.Group.renderGHIRoomHotelList(e,s,$("#"+a))})})}();